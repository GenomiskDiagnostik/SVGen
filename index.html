<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SVGen</title>
  <style>
    :root {
      color-scheme: light dark;
      --bg: #0f172a;
      --card: #1e293b;
      --accent: #38bdf8;
      --text: #e2e8f0;
      --muted: #94a3b8;
      --border: #334155;
    }

    body {
      margin: 0;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 32px;
    }

    .card {
      width: min(1100px, 100%);
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 24px 80px rgba(0, 0, 0, 0.35);
    }

    h1 {
      margin: 0 0 12px;
      font-weight: 800;
      letter-spacing: -0.03em;
    }

    p.description {
      margin: 0 0 16px;
      color: var(--muted);
      line-height: 1.5;
    }

    .title-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
    }

    .title-logo {
      width: 100px;
      height: 100px;
      flex-shrink: 0;
    }

    .controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
      margin-bottom: 20px;
    }

    .control {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px 14px;
    }

    label {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      color: var(--muted);
      margin-bottom: 6px;
    }

    input[type="range"],
    input[type="file"],
    input[type="color"] {
      width: 100%;
      accent-color: var(--accent);
    }

    input[type="color"].swatch {
      width: 48px;
      min-width: 48px;
      height: 36px;
      padding: 0;
    }

    .actions {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin: 12px 0 18px;
    }

    button {
      background: linear-gradient(135deg, #38bdf8, #06b6d4);
      border: none;
      color: #0b1224;
      font-weight: 700;
      border-radius: 12px;
      padding: 12px 16px;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
      box-shadow: 0 10px 30px rgba(56, 189, 248, 0.3);
    }

    button.secondary {
      background: rgba(255, 255, 255, 0.06);
      color: var(--text);
      box-shadow: none;
      border: 1px solid var(--border);
    }

    button:active {
      transform: translateY(1px);
    }

    .status {
      margin: 6px 0 14px;
      color: var(--muted);
      font-size: 14px;
      min-height: 20px;
    }

    .panels {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 16px;
    }

    .panel {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      min-height: 360px;
      position: relative;
    }

    .panel h2 {
      margin-top: 0;
      font-size: 16px;
      color: var(--muted);
    }

    #svgOutput {
      width: 100%;
      min-height: 320px;
      border-radius: 10px;
      border: 1px dashed var(--border);
      background: #0b1224;
      overflow: auto;
      position: relative;
    }

    .hint {
      font-size: 13px;
      color: var(--muted);
      margin-top: 8px;
    }

    .inline-flex {
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .badge {
      padding: 4px 8px;
      border-radius: 6px;
      background: rgba(56, 189, 248, 0.12);
      border: 1px solid rgba(56, 189, 248, 0.3);
      font-size: 12px;
      color: #a5f3fc;
    }

    .hidden {
      display: none;
    }

    .svg-canvas {
      width: 100%;
      height: 100%;
      min-height: 320px;
      display: block;
    }

    .viewport {
      width: 100%;
      min-height: 320px;
      border-radius: 10px;
      border: 1px dashed var(--border);
      background: #0b1224;
      overflow: hidden;
      position: relative;
      cursor: default;
    }

    #previewViewport {
      cursor: grab;
    }

    #previewViewport.dragging {
      cursor: grabbing;
    }

    .viewport-inner {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      transform-origin: center center;
      will-change: transform;
    }

    .viewport canvas,
    .viewport svg {
      max-width: 100%;
      max-height: 100%;
    }

    #svgOutput {
      overflow: hidden;
    }

    input[type="range"].warn-orange {
      accent-color: #fb923c;
    }

    input[type="range"].warn-red {
      accent-color: #f87171;
    }

    .selection-overlay {
      position: absolute;
      top: 0;
      left: 0;
      border: 1px dashed #38bdf8;
      background: rgba(56, 189, 248, 0.15);
      pointer-events: none;
      display: none;
      z-index: 2;
    }

    .effect-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 12px;
      margin: 12px 0 18px;
    }

    .effect-cell {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      display: grid;
      gap: 8px;
    }

    .effect-cell .effect-control {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .effect-cell input[type="range"] {
      flex: 1;
      min-width: 140px;
    }

    .effect-cell input[type="number"] {
      width: 72px;
    }
  </style>
  <script src="./vendor/imagetracer_v1.2.6.js"></script>
</head>
<body>
  <main class="card">
    <div class="title-row">

        <svg class="title-logo" viewBox="0 0 1024 1024" aria-hidden="true" role="img" style="background: transparent; filter: url(&quot;#outer-glow-filter&quot;);"><defs><filter id="outer-glow-filter" x="-50%" y="-50%" width="200%" height="200%" color-interpolation-filters="sRGB"><feGaussianBlur id="glow-blur" in="SourceAlpha" result="blur" stdDeviation="0"/><feFlood id="glow-flood" result="flood" flood-color="#00ffff" flood-opacity="0"/><feComposite id="glow-composite" in="flood" in2="blur" operator="in" result="glow"/><feMorphology id="outline-morph" in="SourceAlpha" operator="dilate" radius="0.3333333333333333" result="outlineBase"/><feFlood id="outline-flood" result="outlineFlood" flood-color="#000000" flood-opacity="1"/><feComposite id="outline-composite" in="outlineFlood" in2="outlineBase" operator="in" result="outline"/><feGaussianBlur id="inner-glow-blur" in="SourceAlpha" result="innerGlowBlur" stdDeviation="0"/><feComposite id="inner-glow-composite" in="innerGlowBlur" in2="SourceAlpha" operator="in" result="innerGlowMask"/><feFlood id="inner-glow-flood" result="innerGlowFlood" flood-color="#ffffff" flood-opacity="0"/><feComposite id="inner-glow-final" in="innerGlowFlood" in2="innerGlowMask" operator="in" result="innerGlow"/><feFlood id="inner-fill-flood" result="innerFillFlood" flood-color="#ffffff" flood-opacity="0"/><feComposite id="inner-fill-composite" in="innerFillFlood" in2="SourceAlpha" operator="in" result="innerFill"/><feMerge><feMergeNode id="merge-outline-node" in="outline"/><feMergeNode id="merge-glow-node" in="glow"/><feMergeNode id="merge-source-node" in="SourceGraphic"/><feMergeNode id="merge-inner-fill-node" in="innerFill"/><feMergeNode id="merge-inner-glow-node" in="innerGlow"/></feMerge></filter></defs><path fill="rgb(0,0,0)" stroke="rgb(0,0,0)" stroke-width="0" opacity="0" d="M 0 0 L 1024 0 L 1024 1024 L 0 1024 L 0 0 Z M 515 121 L 514 124 L 459 123 L 412 124 L 410 124 L 379 123 L 329 124 L 315 126 Q 293 131 280 144 L 274 151 L 273 149 L 268 159 L 264 160 L 255 192 L 256 519 L 256 521 L 258 522 L 258 527 L 264 541 L 264 543 L 266 543 L 269 550 Q 280 563 296 572 L 294 573 L 301 576 L 302 576 L 298 573 L 298 572 Q 311 580 332 580 L 336 579 L 338 579 L 353 580 L 600 579 L 602 579 L 617 580 L 621 579 L 625 580 Q 645 580 658 572 L 661 573 L 660 572 L 675 562 Q 688 551 695 534 L 695 536 L 696 536 L 695 533 L 700 517 L 700 497 L 702 494 L 705 496 L 707 495 L 718 502 L 723 502 L 727 504 L 728 502 L 726 502 L 729 500 L 732 494 L 751 408 L 751 406 L 757 378 L 760 378 L 758 377 L 760 376 L 759 375 L 761 366 Q 759 360 763 361 L 762 360 L 766 345 Q 764 339 768 340 L 767 339 L 773 316 L 773 309 L 767 303 L 761 303 L 733 313 L 731 312 L 725 313 L 728 313 L 730 314 L 708 321 L 702 320 L 700 319 L 700 189 L 694 170 L 696 169 L 695 166 L 694 168 L 692 166 L 694 165 L 691 164 L 683 151 Q 666 128 631 124 L 596 124 L 595 122 L 592 123 L 594 123 L 594 124 L 572 124 L 571 123 L 570 123 L 570 124 L 515 124 L 515 121 Z M 702 293 L 702 302 L 704 299 L 702 298 L 702 293 Z M 273 554 L 273 557 L 272 560 L 276 559 L 278 560 L 273 554 Z M 216 637 Q 187 640 171 655 L 162 666 L 161 664 L 154 686 L 154 699 L 153 687 L 152 687 L 152 703 L 154 703 L 155 700 L 162 720 L 176 731 L 176 734 Q 175 738 181 736 L 181 734 Q 199 744 225 748 L 225 749 L 222 751 L 224 750 L 229 752 Q 230 749 227 750 L 227 749 L 242 755 L 247 765 Q 248 774 244 777 L 241 776 L 242 779 L 236 783 L 233 782 L 232 784 L 228 785 Q 209 787 200 780 L 193 774 L 189 764 L 189 758 L 187 755 L 180 757 L 152 759 L 150 761 Q 151 789 166 803 Q 181 817 209 821 L 208 823 L 214 824 L 217 823 L 212 822 L 220 821 L 219 823 L 222 823 L 224 823 L 228 824 L 231 823 L 221 822 Q 252 820 270 805 Q 287 793 289 767 Q 289 753 285 744 L 287 744 L 284 742 L 277 728 L 276 730 L 268 723 L 266 722 L 265 722 L 258 718 L 255 718 L 254 715 L 254 717 L 218 706 L 216 704 L 214 705 L 206 702 L 197 693 Q 196 684 199 681 Q 203 673 214 672 Q 230 670 239 677 Q 246 683 247 696 L 264 693 L 272 694 L 267 695 L 275 696 L 280 695 L 280 693 L 278 694 L 276 694 L 277 692 L 283 693 L 287 692 L 288 685 L 286 684 Q 286 669 277 661 Q 267 648 250 642 L 248 640 L 246 641 L 224 637 L 220 638 L 218 637 L 216 637 Z M 537 637 Q 508 638 491 650 L 489 650 L 488 652 L 479 658 Q 458 678 453 715 Q 450 770 476 796 L 482 801 L 481 801 L 483 804 L 484 802 Q 500 818 530 821 Q 577 823 599 800 L 611 783 L 611 719 L 608 718 L 547 718 L 542 719 L 541 717 L 539 719 L 538 745 L 539 749 L 540 752 L 573 752 L 573 757 L 574 770 L 570 776 Q 563 782 551 785 L 543 784 L 536 785 L 534 785 L 516 778 Q 498 764 495 736 Q 493 705 506 689 Q 513 678 528 674 Q 547 671 557 679 L 554 679 L 554 680 L 559 679 L 565 684 L 572 700 L 575 701 L 576 703 L 576 702 Q 592 696 612 696 Q 609 677 598 666 L 600 666 L 598 664 L 593 658 L 591 656 Q 581 647 565 642 L 565 641 L 567 642 L 568 640 L 563 641 L 537 637 Z M 288 640 L 289 650 L 289 648 L 291 648 L 289 645 L 290 641 L 298 666 L 297 669 L 296 672 L 300 674 L 300 672 L 297 671 L 300 670 L 301 673 L 300 675 L 302 676 L 300 677 L 302 677 L 306 689 L 304 689 L 307 699 L 308 699 L 306 692 L 307 690 L 323 738 L 323 739 L 322 737 L 321 740 L 320 742 L 323 743 L 324 740 L 331 761 L 331 763 L 330 762 L 328 763 L 332 766 L 337 778 L 336 780 L 338 781 L 345 802 L 344 805 L 345 808 L 346 805 L 349 816 L 351 817 L 401 817 L 407 800 L 407 802 L 408 802 L 407 799 L 460 642 L 460 640 L 420 640 L 418 640 L 415 641 L 412 652 L 411 654 L 411 656 L 394 709 L 393 711 L 393 713 L 384 742 L 383 744 L 383 746 L 376 772 L 336 642 L 335 640 L 288 640 Z M 837 680 L 837 682 L 842 683 Q 821 682 810 691 L 801 701 L 800 701 Q 799 697 802 698 L 801 696 L 800 694 L 802 692 L 802 691 L 800 691 L 800 685 L 762 685 L 762 817 L 763 817 L 800 817 L 800 737 L 804 725 L 812 718 L 812 720 L 813 717 L 817 716 L 825 717 L 824 717 L 825 719 L 831 717 L 833 722 L 836 721 Q 840 723 840 730 L 841 733 L 840 745 L 841 749 L 840 752 L 841 755 L 840 761 L 841 767 L 840 769 L 841 772 L 840 780 L 840 782 L 841 791 L 840 796 L 841 801 L 841 803 L 840 817 L 880 817 L 880 730 Q 879 710 870 700 L 872 697 L 870 696 L 869 698 L 865 693 L 863 691 L 848 684 Q 842 686 843 683 L 845 683 L 847 682 L 846 682 L 837 680 Z M 688 682 Q 661 684 647 698 Q 632 710 628 731 L 627 728 Q 623 726 624 731 L 626 734 L 626 733 L 627 733 L 624 760 L 626 761 L 624 761 L 625 768 L 626 762 Q 628 784 639 798 Q 653 817 683 821 L 678 822 L 681 822 L 683 822 L 682 824 L 685 824 L 687 824 L 695 823 L 691 822 L 691 821 Q 697 819 696 823 L 699 822 L 699 824 L 701 823 L 697 821 Q 716 819 728 809 L 734 802 L 737 800 Q 746 790 747 773 L 715 771 L 712 772 L 709 780 L 695 787 Q 685 788 681 785 L 679 784 L 678 784 L 672 781 Q 664 774 663 761 L 750 761 L 748 760 L 749 755 L 748 752 L 749 744 Q 749 717 736 703 L 722 690 L 720 688 L 700 683 L 692 683 L 690 683 L 688 682 Z M 761 721 L 760 736 L 761 736 L 761 721 Z M 625 735 L 624 746 L 625 746 L 625 735 Z M 761 737 L 759 746 L 760 768 L 761 768 L 761 737 Z M 191 739 L 189 741 L 192 741 L 196 743 L 200 743 L 191 739 Z M 761 769 L 760 793 L 761 793 L 761 769 Z M 761 794 L 760 809 L 761 809 L 761 794 Z "/><path fill="rgb(0,0,0)" stroke="rgb(0,0,0)" stroke-width="0" opacity="0" d="M 684.5 713 L 698 714 L 699 717.5 L 698 719.5 L 700 718.5 Q 698.8 714.8 702.5 716 L 704 719 L 706 720.5 L 706 722.5 L 705.5 725 L 704 724.5 L 705.5 727 L 708 726.5 L 707 723.5 L 709 724.5 L 711 734 L 669.5 735 L 667 734.5 L 668.5 732 L 666 733.5 L 664.5 735 L 665 733.5 Q 665.8 724.3 671.5 720 L 675 719.5 L 673 718.5 L 681.5 714 L 681.5 715 L 680 715.5 L 683 716 L 684.5 713 Z "/><path fill="rgb(230,137,113)" stroke="rgb(230,137,113)" stroke-width="0" opacity="0.996078431372549" d="M 323.5 151 L 530.5 152 L 534.5 152 L 559 152.5 L 541.5 154 L 539.5 153 L 535 154 L 533.5 156 L 533.5 157 L 535 157.5 L 532 158.5 L 530.5 160 L 527 164.5 L 527.5 166 L 525 166.5 L 525 168.5 L 526 170.5 L 524.5 170 L 523 170.5 L 523.5 172 Q 519.1 170.5 520 173.5 L 519 176 L 515 177.5 L 517 178.5 L 515 179 L 514.5 181 L 513.5 179 L 512 181.5 L 513 183.5 L 512.5 185 L 515 185.5 L 512.5 186 L 511 185.5 L 509.5 188 L 507.5 189 L 506.5 187 L 504 192 L 507 193.5 L 505.5 193 L 503 194.5 L 501.5 197 L 503 197.5 L 495 201.5 L 495.5 203 L 497 202.5 L 494.5 203 L 493 205 L 495 205.5 L 493.5 206 L 491 206.5 L 493 207.5 L 490.5 209 L 488 208 L 486.5 216 L 482 214.5 L 483 216.5 L 479 218.5 L 477.5 221 L 475 222.5 L 477 223.5 L 478.5 222 L 475.5 226 L 475 223 L 473 224.5 L 472 229.5 L 471.5 231 L 470.5 229 L 467 231.5 L 466.5 234 Q 464.8 230.3 463 233.5 L 465 234.5 L 463 235 L 464 237.5 L 462 237.5 L 459.5 239 L 458.5 241 L 460 241.5 L 457 242.5 L 457.5 244 L 455 245.5 L 456 248 L 454 246.5 L 453 246.5 L 451.5 249 L 451.5 251 L 450 251.5 L 450.5 253 L 448 253.5 L 449 258 L 447 259.5 L 448 262 Q 443.2 260.1 444 263.5 L 444.5 265 L 442 265 Q 444.3 270.8 440.5 270 L 440 272.5 L 438.5 275 L 438 273.5 L 440 269.5 L 439 267.5 L 440 256.5 Q 436.9 236.6 423.5 227 Q 411.9 216.6 388.5 218 Q 372 221.5 363 232.5 Q 351 243 353 267.5 Q 357.1 285.4 368.5 296 Q 370.5 293 372.5 298 L 383.5 303 L 403 306 L 403.5 304 L 405.5 304 L 408.5 303 L 409 305 Q 403.7 303.8 404.5 307 L 400.5 307 L 398.5 306 L 397.5 309 Q 395.7 305.3 394 308.5 L 393.5 310 L 390.5 309 L 390.5 311 L 387.5 309 L 388 310.5 L 386.5 312 L 384.5 312 L 383 313.5 L 380.5 312 L 379 312.5 Q 381.7 314.3 377.5 316 L 375 314.5 L 373.5 318 L 371.5 317 L 371.5 319 L 369 318 Q 370.3 321 366.5 320 L 366.5 321 L 368 322.5 L 366 322.5 L 365.5 324 L 364.5 322 L 361.5 327 L 358.5 329 L 357 328.5 L 358 331.5 L 356.5 332 L 354.5 332 L 344 337.5 L 347 338.5 L 344 340.5 L 344.5 339 L 341.5 341 L 339.5 345 L 336.5 347 L 336.5 349 L 334.5 349 L 332 349.5 L 332.5 351 L 329.5 350 L 327 353.5 Q 330.8 355.3 327.5 357 L 324.5 359 L 322.5 363 L 321.5 360 L 320 361.5 L 320.5 363 L 317 365.5 L 317.5 367 L 314.5 366 L 311 371.5 L 311.5 373 L 309.5 374 Q 306.8 371.1 304 375.5 L 304.5 377 L 303 376.5 L 301.5 379 L 300 378.5 Q 300.8 381.9 296 380 L 295.5 378 L 295 381 L 288.5 383 L 288.5 382 L 290 381.5 L 287 379.5 L 286.5 378 L 285.5 383 L 283 382.5 L 283 380.5 L 284 378.5 L 283 373.5 L 283 371.5 L 284 365.5 L 283 358.5 L 284 356.5 L 283 189.5 Q 285.8 173.8 295 165 Q 305.3 154.5 323.5 151 Z "/><path fill="rgb(230,137,113)" stroke="rgb(230,137,113)" stroke-width="0" opacity="0.996078431372549" d="M 392.5 240 Q 408.4 239.6 414 249.5 Q 418.8 254.7 417 266.5 L 410.5 277 Q 405.3 283.8 391.5 282 L 378 272.5 Q 373.6 267.4 375 256.5 L 383.5 244 L 392.5 240 Z "/><path fill="rgb(176,108,172)" stroke="rgb(176,108,172)" stroke-width="0" opacity="0.996078431372549" d="M 534.5 151 L 630.5 151 Q 643.2 152.3 651 158.5 L 651.5 160 L 654 160.5 L 654.5 162 L 655.5 161 L 663 168.5 L 662.5 170 L 665 171.5 L 664.5 173 L 667 174.5 L 666 176.5 L 668 176.5 L 667 178.5 L 669 178.5 L 668 180.5 L 670 180.5 L 669 183.5 L 671 183.5 L 670 187.5 L 672 187.5 L 671 213 L 669 213.5 L 670 216 L 666 218.5 L 666.5 220 L 664 220.5 L 663 223.5 L 665 223.5 L 659 226 L 657.5 229 L 652.5 237 L 651 236.5 L 650 240 Q 647 238.8 648 242.5 L 647 242.5 L 646.5 241 L 646 243.5 Q 646.9 246.5 642.5 245 L 641 248 L 638.5 247 L 637.5 249 L 640 249.5 L 637 250.5 L 637.5 252 L 635 251 L 633.5 254 L 631 254.5 L 629.5 257 L 628.5 260 L 624 262.5 L 624.5 264 L 622.5 264 Q 618.8 262.8 620 266.5 L 617 267.5 L 616.5 271 L 616 267 L 614 267.5 L 615 269.5 L 613 269.5 L 611 272.5 L 614 274.5 L 612.5 275 L 609 274 L 607.5 277 L 601 279.5 L 602 281.5 Q 600 278.3 598 281.5 L 596 284.5 L 596.5 286 L 594 284.5 L 593.5 287 L 589.5 284 Q 587.8 286.8 586 282.5 L 587 280.5 L 580 275.5 L 579 272.5 L 578.5 271 L 577.5 272 L 573 267.5 L 572.5 266 L 571 266.5 L 571.5 265 L 569.5 266 L 569.5 264 L 564.5 265 L 562.5 265 L 557.5 265 L 548 270.5 L 543.5 277 L 542 277.5 Q 545.3 279.8 539.5 282 L 536 284.5 L 537 285.5 L 531.5 291 L 530 291.5 L 531 292.5 L 526.5 297 L 524 298.5 L 525 299.5 L 520.5 304 L 517 306.5 Q 519.8 308.3 515.5 310 L 511 313.5 Q 513.8 315.2 509.5 317 L 505 320.5 Q 508.3 322.7 502.5 325 L 499 327.5 Q 502.2 329.8 496.5 332 L 493 334.5 Q 496.2 336.8 490.5 339 L 489 338.5 L 486 342.5 Q 489.3 344.8 483.5 347 L 480 349.5 Q 482.7 351.2 478.5 353 L 477 352.5 L 475 355.5 L 476 356.5 L 471.5 361 L 470 360.5 L 468 363.5 Q 471.2 365.8 465.5 368 L 464 367.5 L 461 371.5 Q 463.7 373.3 459.5 375 L 458 374.5 L 455 378.5 Q 457.8 380.3 453.5 382 L 452 381.5 L 449 385.5 Q 452.2 387.7 446.5 390 L 445 389.5 L 443 392.5 Q 445.8 394.3 441.5 396 L 437 397.5 L 436 394.5 L 434.5 392 Q 432.7 394.8 431 390.5 Q 434 388.5 429 386.5 L 428.5 385 Q 426.3 388.3 424 382.5 Q 426.7 380.8 422.5 379 L 418 375.5 L 417.5 373 L 411 367.5 L 411.5 366 L 406 361.5 L 406.5 360 L 403.5 358 Q 398.9 347.6 382.5 349 L 373 355.5 L 319.5 418 L 318 420.5 L 285.5 458 L 283 457.5 L 283 383.5 L 284.5 380 L 285.5 383 L 286.5 378 L 288.5 381 L 292.5 382 L 292.5 381 L 291 380.5 L 294 378.5 L 293 381 Q 296 382.3 295 378.5 L 297 377.5 L 296 380 Q 300.8 381.9 300 378.5 L 299.5 377 Q 301.3 380.8 303 377.5 L 302.5 376 L 301 376.5 L 302.5 375 L 305 374.5 L 304.5 373 L 309 372.5 L 307.5 370 L 310 370.5 L 310.5 373 L 312 372.5 L 312 370.5 L 313 367.5 L 312.5 366 L 315.5 367 L 318 366.5 Q 315.2 364.8 319.5 363 L 321 362.5 L 320 360 L 322 358.5 L 323 358.5 L 323.5 360 L 326 359 L 327.5 357 L 328 352.5 L 329.5 350 L 332 349.5 L 331.5 348 L 334.5 349 L 338 347 L 337 344.5 L 338.5 345 L 340 344.5 L 339 342.5 L 340 342.5 L 340.5 344 L 341.5 341 L 344.5 339 L 344.5 337 Q 352 336.5 355 331.5 L 354.5 330 L 357.5 332 L 357 330.5 L 357.5 328 L 360 327.5 L 359.5 326 L 361.5 327 L 361.5 325 L 363 325.5 L 364.5 322 L 365.5 324 L 366.5 322 L 368 322.5 L 366.5 321 L 366.5 320 L 370.5 318 L 372.5 317 L 374 317.5 L 375.5 314 Q 377.8 318.3 380 313.5 L 379.5 312 L 382.5 314 L 383 312 L 385.5 311 L 388 312 L 387 309.5 L 388.5 309 L 390.5 309 L 393.5 310 L 395.5 307 Q 397.3 310.8 399 307.5 L 398.5 306 L 405 307 L 404 304.5 L 405.5 305 L 409 305 L 410.5 303 L 412.5 303 L 415 302.5 L 414.5 301 Q 425.2 297.2 431 288.5 L 436 279 L 438 278.5 L 437.5 277 L 439 276.5 L 440 273.5 L 441 271.5 L 439.5 269 L 442 270 Q 439.5 263.8 444.5 265 L 444 263.5 L 448 260.5 L 446 260.5 L 447 258 L 449 256.5 L 448 253.5 L 448.5 251 L 450.5 251 L 452 250.5 L 451.5 249 L 453 246.5 L 454 246.5 L 456 248 L 455 245.5 L 458 243.5 L 457.5 242 L 460 241.5 L 456 239.5 L 458.5 238 L 462 239 L 463 235 L 465 234.5 L 463 233.5 L 467.5 231 L 473 226.5 L 473 224.5 L 474.5 223 L 474.5 221 L 476.5 221 L 479 219.5 L 480.5 217 L 483 216.5 L 482 214.5 L 486 214.5 L 486.5 213 L 487.5 215 L 488 208 L 493 204.5 L 495 201.5 L 499 198.5 L 499.5 196 L 499.5 198 L 503 197.5 L 501 196.5 L 503 193 L 506 192.5 L 504 192 L 506.5 187 L 507.5 189 L 510 187.5 L 509.5 186 L 511 186.5 L 510 184.5 L 513 183.5 L 512.5 182 L 511 182.5 L 513.5 179 L 514.5 181 L 515 179 L 517 178.5 L 514 176.5 L 515.5 177 L 519 176 L 520 172 L 524 171.5 L 522 168.5 L 523 168.5 L 525 170 L 526 167.5 Q 523 165.5 528 163.5 L 529 161.5 L 528.5 160 L 530.5 160 L 532 158.5 L 535 157.5 L 533 156.5 L 535 156 Q 533.7 152.7 538.5 154 L 540.5 153 L 542.5 153 L 559 152.5 L 534.5 152 L 534.5 151 Z "/><path fill="rgb(176,108,172)" stroke="rgb(176,108,172)" stroke-width="0" opacity="0.996078431372549" d="M 257.5 192 L 258 509.5 L 257 509.5 L 257.5 192 Z "/><path fill="rgb(176,108,172)" stroke="rgb(176,108,172)" stroke-width="0" opacity="0.996078431372549" d="M 387.5 378 L 392.5 385 L 399 390.5 L 400 393.5 L 401.5 396 L 402.5 395 L 407 399.5 L 407 401.5 L 409.5 405 Q 411.2 402.3 413 406.5 L 412 408.5 L 411.5 411 L 409.5 410 L 407 411 L 406.5 409 L 406 412 L 400 413 L 399.5 415 L 398.5 413 L 396 414.5 L 396.5 416 L 394 415 Q 395.7 419.1 391.5 418 L 389.5 422 L 388 421.5 L 387.5 423 L 387 420 L 385 420.5 L 385 422.5 Q 385.9 425.5 381.5 424 L 378.5 425 L 377 426.5 L 377.5 428 L 375 426.5 Q 376.5 430.9 373.5 430 L 371 428.5 Q 372.7 434.4 369 433 L 368.5 431 L 367 433.5 L 367.5 435 L 366 434.5 L 365.5 437 L 363.5 436 L 363.5 438 L 360.5 439 L 358 440.5 L 354 442.5 L 355 444.5 L 353 444.5 L 351.5 446 L 351.5 447 L 354 448.5 L 352.5 448 L 349.5 449 L 347 449.5 L 345.5 452 L 343.5 451 L 341.5 455 L 341.5 453 L 340 455.5 L 337 456.5 L 335.5 461 L 334 460.5 Q 335.5 464.9 332.5 464 L 330 464.5 L 329.5 466 L 328 465.5 L 326 470 L 323 471.5 L 322.5 474 L 321 473.5 L 318.5 475 L 318.5 476 L 320 477.5 L 315.5 480 L 313.5 479 L 310 480.5 L 312 481 L 311.5 483 L 308.5 481 L 308 483.5 L 306.5 485 L 304 485.5 L 302.5 488 Q 298.8 486.8 300 490.5 L 299 490.5 L 298.5 489 L 295.5 494 L 294 493.5 Q 295.3 497.3 291.5 496 L 290 496.5 L 289.5 495 L 286.5 499 L 287 497.5 L 290 492.5 Q 286.7 490.2 292.5 488 L 294 488.5 L 297 484.5 Q 294.3 482.7 298.5 481 L 301 480.5 L 303 477.5 Q 299.7 475.3 305.5 473 L 307 473.5 L 310 469.5 Q 306.8 467.2 312.5 465 L 316 462.5 Q 312.7 460.3 318.5 458 L 320 458.5 L 321 456.5 Q 317.8 454.3 323.5 452 L 325 452.5 L 328 448.5 L 327 447.5 L 331.5 443 L 335 440.5 Q 331.8 438.2 337.5 436 L 341 433.5 L 340 432.5 L 344.5 428 L 348 425.5 Q 344.8 423.2 350.5 421 L 354 418.5 Q 350.8 416.2 356.5 414 L 361 410.5 Q 357.8 408.3 363.5 406 L 366 404.5 L 365 403.5 L 369.5 399 L 372 397.5 L 371 396.5 L 376.5 391 L 380 388.5 Q 376.8 386.3 382.5 384 L 385 382.5 Q 381.8 380.3 387.5 378 Z "/><path fill="rgb(176,108,172)" stroke="rgb(176,108,172)" stroke-width="0" opacity="0.996078431372549" d="M 437.5 551 L 448 551.5 L 437.5 552 L 437.5 551 Z "/><path fill="rgb(176,108,172)" stroke="rgb(176,108,172)" stroke-width="0" opacity="0.996078431372549" d="M 294.5 642 L 333 642.5 L 294.5 643 L 294.5 642 Z "/><path fill="rgb(176,108,172)" stroke="rgb(176,108,172)" stroke-width="0" opacity="0.996078431372549" d="M 417.5 642 L 456 642.5 L 417.5 643 L 417.5 642 Z "/><path fill="rgb(176,108,172)" stroke="rgb(176,108,172)" stroke-width="0" opacity="0.996078431372549" d="M 559.5 749 L 574 749.5 L 559.5 750 L 559.5 749 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 699.5 197 L 700 207.5 L 699 207.5 L 699.5 197 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 698.5 243 L 699 262.5 L 698 262.5 L 698.5 243 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 698.5 278 L 699 289.5 L 698 289.5 L 698.5 278 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 698.5 291 L 699 302.5 L 698 302.5 L 698.5 291 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 563.5 294 L 569 300.5 L 563 295.5 L 563.5 294 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 698.5 304 L 700 312.5 L 700 314.5 L 699.5 316 L 698 313.5 L 698 311.5 L 698.5 304 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 697.5 317 L 700 318.5 L 701 322.5 L 688 327.5 L 688.5 329 L 684.5 328 L 678 330.5 L 678.5 332 L 675.5 331 L 672 332.5 L 672.5 334 L 668.5 333 L 611 351.5 L 611.5 353 L 607.5 352 L 594 356.5 L 594.5 358 L 590.5 357 L 583 360.5 L 582 367.5 L 585 368.5 L 584 369.5 L 595 380.5 L 626 412.5 L 623.5 413 L 613 423.5 L 609 428.5 Q 612.2 430.7 606.5 433 L 605.5 432 L 581 456.5 Q 584.3 458.8 578.5 461 L 577.5 460 L 572.5 465 L 564 472.5 L 564.5 474 L 561.5 475 L 556 479.5 L 555.5 482 L 552.5 483 L 547 487.5 L 547.5 489 L 545.5 488 L 542.5 493 L 540.5 493 L 536 496.5 L 536.5 498 L 534.5 497 L 531.5 502 L 529.5 502 L 526 504.5 L 526.5 506 L 524.5 506 L 510 516.5 L 510.5 518 L 508.5 517 L 503 521.5 L 503.5 523 L 501.5 522 L 500.5 525 L 498.5 524 L 497.5 527 L 495.5 527 L 494 527.5 L 494.5 529 L 492.5 528 L 491.5 531 L 489.5 530 L 486 532.5 L 486.5 534 L 484.5 533 L 479 536.5 L 479.5 538 L 477.5 537 L 456 547.5 L 456.5 549 L 454.5 548 L 454.5 550 L 451.5 549 L 441.5 550 L 440.5 548 L 442.5 549 L 442.5 547 L 444.5 548 L 444.5 546 L 446.5 547 L 453 544 L 453.5 542 L 455.5 543 L 455.5 541 L 457 541.5 L 457.5 540 L 459 540.5 L 459.5 539 L 461.5 539 L 465 537.5 L 464.5 536 L 466.5 537 L 466.5 535 L 468.5 536 L 468.5 534 L 470.5 535 L 470.5 533 L 472.5 533 L 476 531.5 L 475.5 530 L 477.5 531 L 477.5 529 L 479.5 529 L 481 528.5 L 480.5 527 L 482 527.5 L 483.5 525 L 485 525.5 L 485.5 524 L 487.5 524 L 489 523.5 L 488.5 522 L 490.5 522 L 492 521.5 L 491.5 520 L 493.5 520 L 495 519.5 L 494.5 518 L 496.5 518 L 498 517.5 L 497.5 516 L 499.5 516 L 501 515.5 L 501.5 513 L 503 513.5 L 504.5 511 L 506.5 511 L 508 510.5 L 508.5 508 L 511 507.5 L 512.5 505 L 514.5 505 L 516 504.5 L 516.5 502 L 518.5 502 L 520 501.5 L 520.5 499 L 523.5 498 L 525 497.5 L 525.5 495 L 528.5 494 L 531 492.5 Q 528.2 490.7 532.5 489 L 535.5 488 L 537 487.5 Q 534.3 485.8 538.5 484 L 541.5 483 L 544 481.5 Q 541.3 479.8 545.5 478 L 546.5 479 L 551.5 474 L 554 472.5 L 553 471.5 L 558.5 466 L 559.5 467 L 564.5 462 L 566 461.5 L 565 460.5 L 582.5 443 L 583.5 444 L 606 421.5 L 605 420.5 L 615 410.5 L 611 406.5 L 601.5 396 L 600.5 397 L 579 375.5 L 578 372.5 L 576.5 370 L 575 369.5 L 576 367.5 L 574 367.5 L 574.5 361 L 576 361.5 L 575 358.5 L 577 358.5 L 576 356.5 L 580.5 352 L 581.5 353 L 583 352.5 L 582.5 351 L 585.5 352 L 585.5 350 L 588.5 351 L 588.5 349 L 592.5 350 L 592.5 348 L 595.5 349 L 595.5 347 L 599.5 348 L 599.5 347 L 598 346.5 L 599.5 346 L 602.5 347 L 602.5 345 L 606.5 346 L 606.5 345 L 605 344.5 L 606.5 344 L 610.5 345 L 617 342.5 L 616.5 341 L 620.5 342 L 627 339.5 L 626.5 338 L 629.5 339 L 629.5 337 L 632.5 338 L 632.5 336 L 635.5 337 L 635.5 335 L 639 336 L 639.5 334 L 642.5 335 L 642.5 333 L 645.5 334 L 645.5 332 L 649 333 L 649.5 331 L 652.5 332 L 652.5 330 L 655.5 331 L 655.5 329 L 658.5 330 L 658.5 328 L 662.5 329 L 662.5 328 L 661 327.5 L 662.5 327 L 665.5 328 L 665.5 326 L 668.5 327 L 668.5 325 L 672.5 326 L 688 320.5 L 687.5 319 L 691.5 320 L 697.5 317 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 435.5 394 L 439.5 397 L 441 396.5 L 438 398.5 L 435.5 394 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 673.5 455 L 676.5 460 Q 678.8 456.8 681 462.5 L 680 463.5 L 688 471.5 L 704 490 L 702 490.5 L 702.5 492 L 700 493.5 L 699.5 500 L 698.5 492 L 697 492.5 L 698 491.5 L 684.5 478 L 678.5 473 Q 676.3 476.3 674 470.5 L 673.5 468 L 669.5 470 L 667 471.5 L 666.5 474 L 664.5 474 L 663 474.5 Q 665.8 476.3 661.5 478 L 658.5 479 L 657 479.5 L 656.5 482 Q 654.5 479 652.5 484 L 651 484.5 Q 653.7 486.3 649.5 488 L 647.5 488 L 646 488.5 L 645.5 491 L 642.5 492 L 641 492.5 Q 643.8 494.3 639.5 496 L 637.5 496 L 636 496.5 L 635.5 499 L 632.5 500 L 631 500.5 L 631.5 502 L 629.5 502 L 628 502.5 L 627.5 505 L 625.5 505 L 624 505.5 L 624.5 507 L 621.5 508 L 620 508.5 L 619.5 511 L 617.5 511 L 616 511.5 L 616.5 513 L 614.5 513 L 613 513.5 L 613.5 515 L 611 515.5 L 609.5 518 L 607.5 517 L 607.5 519 L 605.5 519 L 604 519.5 L 603.5 522 L 601.5 521 L 601.5 523 L 599.5 523 L 598 523.5 L 598.5 525 L 597 524.5 L 595.5 527 L 593.5 526 L 593.5 528 L 591.5 528 L 590 528.5 L 590.5 530 L 588.5 529 L 588.5 531 L 587 530.5 L 586.5 532 L 584.5 532 L 583 532.5 L 583.5 534 L 581.5 533 L 581.5 535 L 580 534.5 L 579.5 536 L 578 535.5 L 576.5 538 L 574.5 537 L 574.5 539 L 572.5 538 L 572.5 540 L 570.5 539 L 570.5 541 L 569 540.5 L 568.5 542 L 567 541.5 L 566.5 543 L 565 542.5 L 564.5 544 L 563 543.5 L 561.5 546 L 559.5 545 L 559.5 547 L 557.5 546 L 557.5 548 L 555.5 547 L 555.5 549 L 553.5 548 L 552.5 551 L 533 549.5 L 539 546.5 L 538.5 545 L 540.5 546 L 540.5 544 L 543.5 545 L 567 532.5 L 566.5 531 L 568.5 532 L 568.5 530 L 570.5 531 L 578 526.5 L 577.5 525 L 579.5 526 L 594 516.5 L 593.5 515 L 595.5 516 L 607 507.5 L 606.5 506 L 608.5 507 L 609.5 504 L 611.5 504 L 614 502.5 L 613.5 501 L 615.5 502 L 616.5 499 L 618.5 499 L 621 497.5 L 620.5 496 L 622.5 497 L 638 484.5 L 637.5 483 L 639.5 483 L 643 480.5 L 642.5 479 L 644.5 479 L 649 475.5 L 648.5 474 L 650.5 474 L 654 471.5 L 654.5 469 L 656.5 469 L 661 465.5 L 660.5 464 L 662.5 464 L 667 460.5 L 667.5 458 L 669.5 458 L 673.5 455 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 285.5 497 L 284 499.5 L 283.5 506 L 283 499.5 L 285.5 497 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 536.5 551 L 551 551.5 L 536.5 552 L 536.5 551 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 373.5 577 L 381 578.5 L 376.5 579 L 373.5 578 L 372 578.5 L 373.5 577 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 399.5 577 L 426 577.5 L 400.5 579 L 399.5 577 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 435.5 577 L 468 577.5 L 435.5 578 L 435.5 577 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 511.5 577 L 522 577.5 L 511.5 578 L 511.5 577 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 525.5 577 L 537 577.5 L 525.5 578 L 525.5 577 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 541.5 577 L 570 577.5 L 541.5 578 L 541.5 577 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 573.5 577 L 626 577.5 L 573.5 578 L 573.5 577 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 528.5 638 L 543 639.5 L 531.5 640 L 528.5 638 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 764.5 685 L 776 686.5 L 768.5 687 L 764.5 685 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 792.5 685 Q 798.6 683.8 798 686.5 L 800 686.5 L 800 688.5 L 799.5 699 L 798 690.5 L 799 688.5 L 792.5 686 L 790.5 687 L 790.5 686 L 792.5 685 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 541.5 719 L 560.5 720 L 565.5 719 L 568 719.5 Q 568.3 723 559.5 721 L 557.5 720 L 552.5 721 L 541.5 720 L 540 720.5 L 541.5 719 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 585.5 719 L 588 720.5 L 586.5 720 L 576.5 721 L 576.5 720 L 585.5 719 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 591.5 719 Q 599 717 601 720.5 L 598.5 721 L 596.5 721 L 593.5 720 L 589.5 721 L 589.5 720 L 591.5 719 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 453.5 724 L 455 731.5 L 453.5 736 L 453.5 724 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 799.5 742 L 800 744.5 L 799 808.5 L 800 815.5 L 798 814.5 L 798 743.5 L 799.5 742 Z "/><path fill="rgb(57,59,68)" stroke="rgb(57,59,68)" stroke-width="0" opacity="0.9529411764705882" d="M 574.5 751 L 576 752.5 L 576 765.5 L 575 765.5 L 574.5 751 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 701.5 263 L 704 266.5 L 701 268.5 L 703 265.5 L 701 265.5 L 701.5 263 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 701.5 293 L 702 298 L 704 298.5 L 704 300.5 L 702.5 303 Q 698.7 300.7 701.5 293 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 258.5 526 L 258 527.5 L 261 535.5 L 259 536 L 257.5 530 L 256.5 532 L 256 530.5 L 258.5 526 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 313.5 577 L 313.5 579 L 316 579.5 L 312.5 582 L 312.5 581 L 314 580.5 L 311 578.5 L 313.5 577 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 410 650 L 413 651.5 L 411 651.5 L 409.5 653 L 408 653.5 L 408.5 651 L 410 651.5 L 410 650 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 297.5 666 L 299 666.5 L 299.5 670 L 297 670.5 L 300 672 L 301.5 674 L 301.5 675 L 297.5 673 L 296 673.5 L 296 671.5 L 297 668.5 L 297.5 666 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 530.5 673 L 542 673.5 L 530.5 674 L 530.5 673 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 520.5 676 L 523 677.5 L 517.5 680 L 517.5 679 L 519 678.5 L 518.5 677 L 520.5 678 L 520.5 676 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 560.5 682 L 563.5 686 L 565.5 685 L 565 686.5 L 564.5 688 L 561 686 L 560.5 682 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 304.5 688 L 307 689.5 L 306 691.5 L 308 696.5 L 306 697 L 305.5 695 L 304 695.5 L 305 691.5 L 304.5 688 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 271.5 692 L 277 693.5 Q 278.1 697.7 274 696 L 273.5 694 L 267.5 695 L 267.5 694 L 272 693.5 L 271.5 692 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 644.5 698 L 647 698.5 L 641 703.5 L 641.5 699 L 643 700.5 L 645 699.5 L 644.5 698 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 572.5 699 L 582 701 L 581.5 703 L 576.5 701 L 574.5 701 L 572.5 699 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 245.5 712 L 249.5 713 L 252 713.5 L 250.5 716 L 251 714.5 L 250.5 713 L 248.5 713 L 243.5 714 L 243.5 713 L 245.5 712 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 698.5 714 L 701 715.5 L 700 718.5 L 701.5 718 L 703 718.5 L 700.5 720 L 698 719.5 L 696.5 718 L 696.5 717 L 698.5 714 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 825.5 716 L 828 716.5 L 827.5 718 L 830 718.5 L 827.5 720 L 826.5 718 L 824.5 719 L 823.5 717 L 825.5 716 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 543.5 717 L 546.5 718 L 608 718.5 L 544.5 719 L 542 718.5 L 543.5 717 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 831.5 717 L 838 722.5 Q 836 727 834 723.5 L 834.5 722 L 833 719.5 L 831.5 717 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 626.5 720 L 627.5 722 Q 629.2 718.3 631 721.5 L 625.5 723 L 624 721.5 L 626 721.5 L 626.5 720 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 705.5 721 L 708 722.5 L 707 724.5 L 708 726.5 L 705.5 727 L 704 724.5 L 706 724.5 L 705.5 722 L 704 722.5 L 705.5 721 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 177.5 732 L 178.5 735 L 179.5 733 L 180.5 735 L 182 734.5 L 178.5 736 Q 174.8 737.3 176 733.5 L 177.5 732 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 671.5 734 L 711 734.5 L 671.5 735 L 671.5 734 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 184.5 738 L 187.5 739 L 189.5 740 L 191.5 740 L 193.5 739 L 193.5 741 L 196.5 740 L 196.5 742 L 198 742.5 L 195.5 743 L 192 743.5 L 193 741 L 187.5 740 Q 185.3 743 184.5 738 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 225.5 748 L 227 748.5 L 226.5 750 L 229.5 749 L 229 750.5 L 228.5 752 L 226.5 752 L 223.5 750 L 222 750.5 L 224.5 749 L 225.5 748 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 544.5 751 L 573.5 751 L 574 752.5 L 572.5 752 L 544.5 752 L 544.5 751 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 377.5 752 Q 380.5 751.1 379 755.5 L 378 758 L 376 758.5 L 378 764.5 L 375 763.5 L 374.5 765 L 374 763.5 L 373.5 760 L 376 761.5 L 375 756.5 L 378 755.5 L 377.5 753 L 376 753.5 L 377.5 752 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 573.5 756 L 574 768.5 L 573 768.5 L 573.5 756 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 624.5 767 L 626 769.5 L 625 771.5 L 627 775.5 L 628 779.5 L 627 779.5 L 625 776.5 L 625 774.5 L 624 769.5 L 624.5 767 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 561 776 L 563 776.5 L 562 780 L 556.5 782 L 554 781.5 L 554.5 779 L 557.5 780 L 561 777.5 L 561 776 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 624.5 778 L 627.5 782 L 629 783.5 L 627.5 783 L 624.5 784 L 625 782.5 L 624.5 778 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 760.5 778 L 761 791.5 L 760 791.5 L 760.5 778 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 690.5 784 L 692.5 784 L 697 786.5 L 695.5 787 L 692.5 786 L 690.5 784 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 473.5 794 L 480 798.5 Q 477 794.1 474 797.5 L 473.5 794 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 733.5 802 L 731.5 806 L 733 806.5 L 731.5 807 L 727 808.5 L 733.5 802 Z "/><path fill="rgb(244,244,244)" stroke="rgb(244,244,244)" stroke-width="0" opacity="0.01568627450980392" d="M 705.5 820 L 704.5 822 L 702.5 823 L 699.5 824 L 698 823.5 L 700 822.5 L 699.5 821 L 703.5 821 L 705.5 820 Z "/><path fill="rgb(92,120,205)" stroke="rgb(92,120,205)" stroke-width="0" opacity="0.996078431372549" d="M 671.5 189 L 673 207.5 L 673 209.5 L 673 322.5 L 670.5 325 L 633 336 L 631.5 333 L 627 329.5 Q 629.8 327.8 625.5 326 L 622.5 324 L 619.5 319 L 614 314.5 Q 617.3 312.3 611.5 310 L 608 307.5 L 609 306.5 L 604.5 302 L 599 297.5 Q 601.7 295.8 597.5 294 L 595 292.5 L 596 291.5 L 591.5 287 L 589 285.5 L 588 283.5 L 590.5 285 L 593.5 287 L 594.5 284 L 596 284.5 L 598 281.5 L 601 280.5 L 602.5 278 L 609 275.5 L 611.5 274 L 611 272.5 L 613 269.5 L 615 269.5 L 614 267.5 L 616 266.5 L 615.5 265 Q 617.7 270.3 620 266.5 Q 618.8 262.8 622.5 264 L 629 259.5 L 629.5 257 L 631 254.5 L 635 252.5 L 636.5 251 L 640 249.5 L 637 248.5 L 640 246.5 L 639.5 248 L 641 246.5 L 646 245 L 645 242.5 L 647 241.5 L 647.5 243 L 648 240 L 650 238.5 L 651.5 236 L 653 236.5 L 657.5 229 L 660.5 226 L 664 224.5 L 663 222.5 L 668.5 216 L 670 214.5 L 669.5 213 L 671 212.5 L 671.5 189 Z "/><path fill="rgb(92,120,205)" stroke="rgb(92,120,205)" stroke-width="0" opacity="0.996078431372549" d="M 574.5 267 L 587 281.5 L 584 279.5 L 574.5 267 Z "/><path fill="rgb(92,120,205)" stroke="rgb(92,120,205)" stroke-width="0" opacity="0.996078431372549" d="M 561.5 295 L 563.5 296 L 565 295.5 L 564 296.5 L 568.5 301 L 572 303.5 Q 568.8 305.8 574.5 308 L 578 310.5 L 577 311.5 L 582.5 317 L 587 320.5 Q 584.3 322.3 588.5 324 L 593 327.5 Q 589.8 329.8 595.5 332 L 601 336.5 Q 597.8 338.7 603.5 341 L 606 342.5 L 604.5 345 L 582.5 351 L 576 356.5 L 574 367.5 Q 584 385.5 600.5 397 L 615 410.5 L 583.5 443 Q 547.4 479.9 505.5 511 Q 474.2 534.9 435 550 L 434.5 552 L 425.5 552 L 328.5 551 L 326.5 551 Q 319.5 552.5 320 549.5 L 318.5 550 L 311 548 L 310.5 546 L 308.5 546 L 305 545 L 304.5 543 Q 302.7 545.8 301 541.5 L 300.5 540 Q 298.3 543.3 296 537.5 L 294.5 536 L 292 531.5 L 291.5 530 L 290 530.5 L 290.5 529 L 289 528.5 L 289 526.5 L 288.5 525 L 287 525.5 L 288 523 L 286 522.5 L 287 520.5 L 286 517 L 284 516.5 L 285 513.5 Q 281.8 512.3 283 506.5 L 284 503.5 L 285 500.5 L 286.5 495 L 288 495.5 L 287 497.5 L 289 496.5 L 289.5 495 L 290.5 497 L 294 496 L 294.5 493 L 297 492.5 L 296.5 491 L 298 491.5 L 298.5 489 L 299.5 491 L 300 488 L 304 486.5 L 305.5 484 L 308 485 L 309 482.5 L 308.5 481 L 316.5 477 L 316.5 479 L 320 477.5 L 318.5 476 L 318.5 475 L 321 473.5 L 323 470 L 326 468.5 L 328.5 465 L 330 465.5 L 330.5 464 L 332.5 464 Q 335.5 464.9 334 460.5 L 336 460.5 L 337.5 456 L 340 455.5 L 339.5 453 L 338 453.5 L 340.5 453 L 342.5 454 Q 345.7 452 342.5 450 L 344.5 451 L 347 450.5 L 346 448.5 L 349.5 449 L 351 448.5 L 351.5 446 L 353 444.5 L 355 444.5 L 354 442.5 L 358 440.5 L 360.5 439 L 361.5 436 L 363.5 436 L 365.5 437 L 369 430.5 L 368.5 429 L 369 431.5 L 371 433 L 371.5 428 L 374 428.5 L 373.5 430 Q 376.5 430.9 375 426.5 L 377 426.5 L 378.5 425 L 381.5 424 Q 385.9 425.5 385 422.5 L 385.5 420 L 387 422.5 L 388 422.5 L 390 419.5 L 387 418.5 L 391.5 416 L 391.5 417 L 390 418.5 L 391.5 418 L 394 418 L 395.5 415 L 399.5 412 L 402.5 413 L 406 412 L 406.5 409 L 407 411 L 409 410.5 L 409.5 408 L 411 408.5 L 409 409.5 L 411.5 411 L 412.5 408 L 418 412.5 L 416 412.5 L 417.5 414 L 426 421.5 Q 422.8 423.8 428.5 426 L 435 431.5 Q 432.3 433.3 436.5 435 L 441 438.5 Q 438.3 440.3 442.5 442 L 447 445.5 L 447.5 448 L 454 453.5 L 453 454.5 L 457.5 459 L 462 462.5 L 463 466 L 468 469.5 L 469.5 472 L 475.5 480 Q 479.4 485.6 488.5 486 L 497 480.5 Q 500.2 477.2 499 469.5 L 491.5 458 L 489 456.5 L 479.5 444 L 475 440.5 L 475.5 439 L 469 433.5 Q 471.7 431.8 467.5 430 L 463 426.5 Q 466.2 424.3 460.5 422 L 456 418.5 L 460.5 412 L 465 408.5 Q 462.3 406.8 466.5 405 L 471 401.5 Q 468.2 399.7 472.5 398 L 477 394.5 Q 474.2 392.8 478.5 391 L 483 387.5 Q 479.8 385.3 485.5 383 L 490 379.5 L 490.5 377 L 496 372.5 Q 493.2 370.7 497.5 369 L 502 365.5 Q 498.8 363.3 504.5 361 L 508 358.5 Q 504.8 356.3 510.5 354 L 514 351.5 Q 511.3 349.8 515.5 348 L 521 343.5 Q 517.8 341.3 523.5 339 L 527 336.5 Q 524.3 334.8 528.5 333 L 533 329.5 Q 530.3 327.8 534.5 326 L 539 322.5 Q 535.8 320.3 541.5 318 L 546 314.5 Q 543.3 312.8 547.5 311 L 552 307.5 Q 549.2 305.7 553.5 304 L 558 300.5 L 557 299.5 L 561.5 295 Z "/><path fill="rgb(92,120,205)" stroke="rgb(92,120,205)" stroke-width="0" opacity="0.996078431372549" d="M 492.5 335 L 490 338.5 L 483.5 346 L 489 339.5 L 492.5 335 Z "/><path fill="rgb(92,120,205)" stroke="rgb(92,120,205)" stroke-width="0" opacity="0.996078431372549" d="M 482.5 347 L 478 352.5 L 472.5 359 L 477 353.5 L 482.5 347 Z "/><path fill="rgb(92,120,205)" stroke="rgb(92,120,205)" stroke-width="0" opacity="0.996078431372549" d="M 470.5 360 L 471 361.5 L 463.5 370 L 464 368.5 L 470.5 360 Z "/><path fill="rgb(92,120,205)" stroke="rgb(92,120,205)" stroke-width="0" opacity="0.996078431372549" d="M 422.5 379 L 430 387.5 L 428 386.5 L 422.5 379 Z "/><path fill="rgb(92,120,205)" stroke="rgb(92,120,205)" stroke-width="0" opacity="0.996078431372549" d="M 331.5 444 L 325 451.5 L 315.5 463 L 319 458.5 L 331.5 444 Z "/><path fill="rgb(92,120,205)" stroke="rgb(92,120,205)" stroke-width="0" opacity="0.996078431372549" d="M 670.5 470 L 673 471.5 Q 675.6 499.6 671 520.5 Q 666.7 533.2 657.5 541 Q 648.2 549.2 633.5 552 L 551.5 552 L 551.5 551 Q 618.8 518.3 670.5 470 Z "/><path fill="rgb(92,120,205)" stroke="rgb(92,120,205)" stroke-width="0" opacity="0.996078431372549" d="M 301.5 478 L 301 479.5 L 296.5 485 L 299 481.5 L 301.5 478 Z "/><path fill="rgb(92,120,205)" stroke="rgb(92,120,205)" stroke-width="0" opacity="0.996078431372549" d="M 294.5 486 L 294 487.5 L 288.5 494 L 293 488.5 L 294.5 486 Z "/><path fill="rgb(92,120,205)" stroke="rgb(92,120,205)" stroke-width="0" opacity="0.996078431372549" d="M 540.5 728 L 541 743.5 L 540 743.5 L 540.5 728 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 325.5 125 L 633.5 125 Q 665.6 129.9 682 150.5 Q 694.7 164.3 699 186.5 L 700 309.5 L 699 309.5 L 698 303.5 L 699 291.5 L 699 289.5 L 698 276.5 L 699 273.5 L 699 271.5 L 698 263.5 L 699 243.5 L 697 182.5 Q 690.1 156.4 671.5 142 Q 657.1 129.4 633.5 126 L 325.5 126 L 325.5 125 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 318.5 126 L 324 126.5 Q 290.4 131.9 273 153.5 Q 260.7 167.7 257 190.5 L 257 512.5 Q 261.9 545.1 283.5 561 Q 294.1 570.4 309.5 575 L 318.5 577 L 351.5 578 L 360 577 Q 361.3 580 357.5 579 L 355.5 579 L 352.5 578 L 337.5 579 L 335.5 579 L 328.5 578 L 326.5 578 L 317.5 578 L 300.5 573 Q 282.8 564.7 271 550.5 Q 258.9 536.1 256 512.5 L 256 189.5 Q 261.4 160.9 279.5 145 Q 294 130.5 318.5 126 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 759.5 304 Q 768.2 302.8 771 307.5 L 773 312.5 L 760 362.5 L 731 494.5 L 725.5 501 L 719.5 502 L 688 472.5 L 672.5 456 Q 612.9 512.9 533 549.5 L 551.5 550 L 561.5 544 L 560.5 546 L 551.5 551 L 528.5 552 L 528 550 Q 563.3 535.9 593.5 516 Q 635.4 487.9 672.5 455 L 716.5 499 L 721.5 501 L 729 496.5 L 764 340.5 L 772 312.5 L 767.5 306 L 760.5 305 L 650.5 341 L 587.5 359 L 584 361.5 L 583 366.5 L 626 411.5 L 582.5 457 Q 540.1 498.6 489.5 532 L 451.5 551 L 436.5 551 L 436.5 550 L 452.5 543 L 452.5 544 L 441 549.5 L 450.5 550 Q 492.5 533 524.5 506 Q 572.1 468.6 613 424.5 L 625 411.5 L 582 367.5 L 582 362.5 L 584.5 359 L 710.5 321 L 759.5 304 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 698.5 315 L 699 317 L 660.5 329 L 660.5 328 L 698.5 315 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 656.5 329 L 659 329.5 L 650.5 332 L 650.5 331 L 656.5 329 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 633.5 336 L 636 336.5 L 597.5 348 L 597.5 347 L 633.5 336 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 583.5 351 L 586 351.5 L 577 357.5 L 575.5 362 L 575 359.5 L 581.5 352 L 583.5 351 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 576.5 370 L 611 405.5 L 576 371.5 L 576.5 370 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 614.5 412 L 565.5 462 L 512.5 507 L 514.5 504 Q 568.6 462.1 614.5 412 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 671.5 468 L 668.5 472 L 611.5 516 L 613.5 513 L 671.5 468 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 673.5 468 L 699 492.5 Q 701.6 517.1 695 532.5 Q 687.3 550.3 673.5 562 Q 657.8 576.8 629.5 579 L 401.5 579 L 401.5 578 L 428.5 577 L 431.5 578 L 434.5 577 L 467.5 578 L 469.5 578 L 476.5 577 L 481.5 578 L 484.5 577 L 488.5 578 L 494.5 577 L 497.5 578 L 500.5 577 L 503.5 578 L 510.5 577 L 521.5 578 L 524.5 577 L 536.5 578 L 540.5 577 L 569.5 578 L 572.5 577 L 625.5 578 Q 666.1 575.1 684 549.5 Q 694.1 536.6 698 517.5 L 698 492 L 673.5 468 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 510.5 507 L 507.5 511 L 504.5 513 L 506.5 510 L 510.5 507 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 502.5 513 L 500.5 516 L 486.5 525 L 487.5 523 L 502.5 513 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 609.5 516 L 608.5 518 L 597.5 525 L 598.5 523 L 609.5 516 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 595.5 525 L 594.5 527 L 587.5 531 L 588.5 529 L 595.5 525 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 481.5 527 L 480.5 529 L 460.5 540 L 461.5 538 L 481.5 527 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 576.5 536 L 575.5 538 L 569.5 541 L 570.5 539 L 576.5 536 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 362.5 577 L 367.5 578 L 372.5 577 L 375.5 578 L 382.5 577 L 383.5 579 L 376.5 578 L 373.5 579 L 370.5 578 L 361.5 579 L 362.5 577 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 385.5 577 L 391.5 578 L 398.5 577 L 399.5 579 L 386.5 579 L 385.5 577 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 214.5 638 L 226 638.5 L 207.5 640 L 207.5 639 L 214.5 638 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 531.5 638 Q 574.1 637.9 594 660.5 Q 607.3 673 610 695 L 597.5 696 L 597.5 695 L 609 694 Q 604.3 669.4 587.5 656 Q 568.1 638.9 531.5 639 Q 494.1 642.1 476 664.5 Q 454.1 686.1 454.5 730 L 454 711.5 Q 460 673 485.5 654 Q 502.5 640 531.5 638 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 227.5 639 Q 260.9 640.6 276 660.5 Q 285.5 670 286 688.5 L 285 688.5 Q 282.7 662.8 265.5 652 L 250.5 644 Q 241.2 639.8 227.5 640 L 227.5 639 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 201.5 640 L 206 640.5 Q 178.9 645.4 165 663.5 Q 158.4 671.4 156 683.5 L 156 700.5 Q 159.5 717 170.5 726 L 190.5 737 L 236.5 750 L 247 758.5 L 249 769.5 L 242.5 781 Q 233.3 788.8 214.5 787 Q 201.4 785.1 194 777.5 Q 187.5 770.4 187 758 L 150.5 761 L 150.5 760 L 186.5 756 L 191 770.5 L 198.5 780 Q 208.1 787.4 226.5 786 Q 239.1 784.6 245 776.5 L 248 768.5 Q 247.9 758.1 241.5 754 L 224.5 747 L 187.5 737 Q 172.1 731.4 163 719.5 Q 152.2 708.3 155 683.5 Q 159.3 664.3 172.5 654 Q 184.4 644.4 201.5 640 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 291 641 L 334.5 641 L 335 643.5 L 375.5 774 L 416 641 L 457.5 641 L 459 642.5 L 399.5 816 L 350.5 816 L 350 814.5 L 291 641 Z M 292 642 L 350 814 L 352 815 L 400 815 L 458 644 L 458 642 L 417 642 L 376 775 Q 377 778 374 777 L 334 645 L 334 642 L 292 642 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 213.5 670 Q 236.1 667.9 244 680.5 L 248 690.5 L 248.5 693 L 285.5 690 L 285.5 691 L 247.5 694 L 245 684.5 L 238.5 676 Q 230.8 669.2 214.5 671 Q 203.9 672.5 199 679.5 L 196 690.5 L 204.5 702 L 216.5 707 L 253.5 717 Q 270.2 722.8 280 735.5 Q 289.8 747.2 288 770.5 Q 284.5 794 268.5 805 L 249.5 815 L 249.5 814 Q 265.9 808.4 276 796.5 Q 288.7 783.7 287 756.5 Q 284.3 738.2 272.5 729 L 253.5 718 L 207.5 705 L 198 697.5 L 195 685.5 L 201.5 675 L 213.5 670 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 527.5 672 Q 558.5 669 569 686.5 L 574 699 L 595.5 696 L 595.5 697 L 574.5 700 L 568 687.5 L 559.5 679 Q 549.3 670.7 528.5 673 Q 513.4 676.4 506 687.5 Q 491.3 705.3 495 741.5 Q 498.5 766 514.5 778 Q 525.3 788.2 548.5 786 Q 565.8 783.3 574 771.5 L 574.5 752 L 575 771.5 L 568.5 779 Q 557.2 789.2 533.5 787 Q 515.3 783.7 506 771.5 Q 490.2 752.8 494 714.5 Q 497.6 691.1 512.5 679 L 527.5 672 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 685.5 683 L 694 683.5 Q 656 684.5 640 707.5 Q 624.6 725.1 627 760.5 Q 630.5 790 648.5 805 Q 664.7 820.8 698.5 819 Q 723.9 814.9 736 797.5 L 745.5 777 L 746 779.5 Q 740.6 797.6 727.5 808 Q 712.6 821.6 682.5 820 Q 653.2 815.8 639 796.5 Q 623.9 777.6 626 741.5 Q 629.3 712.3 647.5 698 Q 660.8 684.8 685.5 683 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 695.5 684 Q 722.8 685.7 735 702.5 Q 746.4 713.6 747 735.5 L 746 735.5 Q 744.3 710.3 729.5 698 L 717.5 690 L 701.5 685 L 695.5 685 L 695.5 684 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 828.5 684 Q 858 682 869 698.5 Q 876.9 708.1 879 723.5 L 879 816 L 842 816 L 842 732.5 L 835.5 719 L 827 715.5 L 830.5 715 L 839 721.5 L 843 732.5 L 843 815 L 878 815 L 878 723.5 Q 875.1 701.9 860.5 692 L 848.5 686 L 828.5 685 L 828.5 684 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 768.5 685 L 791.5 685 L 793 686.5 L 791.5 686 L 786.5 687 L 783.5 686 L 776.5 687 L 768.5 686 L 765.5 687 L 765.5 686 L 768.5 685 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 823.5 685 L 827 685.5 Q 811.4 688.9 803 699.5 L 798.5 706 L 798 691.5 L 799 691.5 L 799 701.5 L 801 702 L 808.5 693 L 823.5 685 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 763.5 688 L 764.5 816 L 798.5 815 L 798.5 816 L 764.5 817 L 763 815.5 L 763.5 688 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 685.5 711 Q 702.1 709.9 708 719.5 Q 713.3 725.9 713 737 L 662 736.5 L 672.5 735 L 712 735 Q 711.1 722.7 703.5 716 Q 697.4 711.1 685.5 712 Q 673 713.5 668 722.5 L 663.5 735 L 663 731.5 Q 665.6 720.6 673.5 715 L 685.5 711 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 817.5 714 L 826 714.5 Q 810.1 714.1 804 723.5 Q 798.9 730.4 799 742.5 L 799.5 744 L 798 740.5 Q 797.9 725.4 806.5 719 L 817.5 714 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 540.5 719 L 543 720.5 L 541.5 721 L 540 720.5 L 540 750 L 575.5 750 L 575.5 751 L 540.5 751 L 539 749.5 L 539 720.5 L 540.5 719 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 568 719 L 584.5 719 L 587 720.5 L 585.5 721 L 576.5 720 L 572.5 721 L 570.5 721 Q 566.8 722 568 719 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 609.5 720 L 610 782.5 Q 603.7 795.7 592.5 804 Q 570.7 822.7 527.5 820 Q 493.9 815.1 476 794.5 Q 455 773.5 454 732.5 L 455 732.5 L 455 745.5 L 461 768.5 Q 469.3 788.3 484.5 801 Q 506.2 821.8 551.5 819 Q 583.8 814.3 601 794.5 L 609 782.5 L 609.5 720 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 747.5 737 L 748 760 L 663.5 760 L 663 766.5 L 670 781 Q 677.6 788.7 694.5 788 Q 706.1 786.1 711 777.5 L 713 773 Q 730.9 771 744 774.5 L 736.5 775 L 714.5 774 L 705.5 785 Q 698.7 790.2 685.5 789 Q 672.8 787.2 667 778.5 Q 661.8 771.2 661 759.5 L 747 759 L 747.5 737 Z "/><path fill="rgb(9,8,8)" stroke="rgb(9,8,8)" stroke-width="0" opacity="0.9568627450980393" d="M 151.5 765 Q 153.5 790 168.5 802 Q 188.3 821.7 230.5 819 L 247.5 815 L 247.5 816 Q 232.3 822.3 208.5 820 Q 180.5 816.5 165 800.5 Q 151.7 788.1 151.5 765 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 328.5 124 L 629 124.5 L 328.5 125 L 328.5 124 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 255.5 195 L 256 502.5 L 255 502.5 L 255.5 195 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 704.5 490 L 712 496.5 L 710.5 496 L 706.5 495 L 704 496 L 704.5 490 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 271.5 551 L 279.5 560 L 277.5 560 L 276 558.5 L 277 557.5 L 271.5 551 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 293.5 640 L 312 640.5 L 293.5 641 L 293.5 640 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 423.5 640 L 440 640.5 L 423.5 641 L 423.5 640 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 610.5 720 L 611 781.5 L 610 781.5 L 610.5 720 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 879.5 729 L 880 816.5 L 879 816.5 L 879.5 729 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 841.5 735 L 842 760.5 L 841 760.5 L 841.5 735 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 663.5 760 L 736 760.5 L 663.5 761 L 663.5 760 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 841.5 762 L 842 817 L 840 816.5 L 841.5 762 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 153.5 781 L 153 782.5 L 153.5 785 L 155 784.5 L 154 787 L 152 786.5 L 152 784.5 L 153.5 781 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 211.5 820 L 227 820.5 L 211 821.5 L 214 822 L 213.5 824 L 210.5 822 L 208 823 L 208.5 821 L 211.5 820 Z "/><path fill="rgb(167,167,167)" stroke="rgb(167,167,167)" stroke-width="0" opacity="0.14901960784313725" d="M 683 820 L 695 820.5 L 684 821.5 L 686 822.5 L 682.5 824 L 682.5 823 L 684 822.5 L 683 820 Z "/><path fill="rgb(139,84,99)" stroke="rgb(139,84,99)" stroke-width="0" opacity="0.6980392156862745" d="M 762.5 688 L 763 813.5 L 762 813.5 L 762.5 688 Z "/><path fill="rgb(139,84,99)" stroke="rgb(139,84,99)" stroke-width="0" opacity="0.6980392156862745" d="M 400.5 815 L 399.5 817 L 351 816.5 L 400.5 815 Z "/><path fill="rgb(139,84,99)" stroke="rgb(139,84,99)" stroke-width="0" opacity="0.6980392156862745" d="M 768.5 816 L 800 816.5 L 768.5 817 L 768.5 816 Z "/><path fill="rgb(139,84,99)" stroke="rgb(139,84,99)" stroke-width="0" opacity="0.6980392156862745" d="M 846.5 816 L 879 816.5 L 846.5 817 L 846.5 816 Z "/><path fill="rgb(246,246,245)" stroke="rgb(246,246,245)" stroke-width="0" opacity="0.996078431372549" d="M 329.5 126 L 625.5 126 Q 662.1 127.9 679 149.5 Q 694.1 164.4 698 190.5 L 698 316 L 672.5 324 L 673 322.5 L 673 195.5 Q 670.4 172.1 655.5 161 Q 645.9 153.1 630.5 151 L 323.5 151 Q 305.3 154.5 295 165 Q 285.8 173.8 283 189.5 L 282 460.5 L 284 461 L 375.5 353 Q 379.9 347.4 391.5 349 Q 401.5 352 406 360.5 L 438.5 399 L 440 397.5 L 551.5 268 L 563.5 264 Q 575.1 265.9 580 274.5 L 633 335.5 L 606 344 L 562.5 293 L 456 418.5 L 498 466.5 L 499 476.5 L 493.5 484 L 486.5 486 Q 477.6 484.4 474 477.5 L 387.5 378 L 283 498.5 L 283 512.5 Q 286.7 532.3 300.5 542 Q 312.9 552.6 336.5 552 L 338.5 552 L 350.5 551 L 357.5 552 L 359.5 552 L 366.5 551 L 373.5 552 L 376.5 551 L 389.5 552 L 392.5 551 L 412.5 552 L 424.5 551 L 447.5 552 L 450.5 551 L 483.5 536 L 529.5 504 Q 577 466 618 421.5 L 627 411.5 L 584 367.5 L 584 361 L 764.5 305 L 770 308.5 L 771 315.5 L 759 360.5 L 730 492.5 L 725.5 499 L 718.5 500 L 714 497 L 712 493.5 L 691 473.5 L 672.5 454 Q 636.2 487.2 594.5 515 Q 562.7 535.7 526 551.5 L 633.5 552 Q 651.4 548.9 661 537.5 Q 669.2 529.2 672 515.5 L 673 471.5 L 672 469.5 L 683.5 480 L 688.5 484 L 698 494.5 L 698 514.5 Q 692.9 544.4 673.5 560 Q 659.1 573.1 635.5 577 L 320.5 577 Q 289.5 571 273 550.5 Q 261.7 537.3 258 516.5 L 258 186.5 Q 263.7 160.7 280.5 146 Q 298 129 329.5 126 Z "/><path fill="rgb(246,246,245)" stroke="rgb(246,246,245)" stroke-width="0" opacity="0.996078431372549" d="M 388.5 218 Q 418.9 217.1 431 234.5 Q 441.1 244.9 440 266.5 Q 436.9 286.4 423.5 296 Q 413.1 306.1 391.5 305 Q 372.8 301.7 363 289.5 Q 351.2 278.3 353 253.5 Q 356.5 237 367.5 228 Q 375.5 220.5 388.5 218 Z M 393 240 L 384 244 L 375 257 Q 374 267 378 273 L 392 282 Q 405 284 411 277 L 417 267 Q 419 255 414 250 Q 408 240 393 240 Z "/><path fill="rgb(246,246,245)" stroke="rgb(246,246,245)" stroke-width="0" opacity="0.996078431372549" d="M 208.5 640 Q 256.9 636.6 276 662.5 Q 284.4 673 285 690 L 248 693 Q 247.4 681 239.5 675 Q 231.7 668.8 217.5 669 Q 203.1 670.1 197 679.5 Q 193.9 683.9 195 692.5 L 203.5 703 Q 225.6 712.9 252.5 718 Q 269 724 279 736.5 Q 289.1 748.9 286 774.5 Q 281.7 794.2 267.5 804 Q 248.6 820.1 212.5 819 Q 178.1 815.9 162 794.5 Q 151.6 782.4 152 761 L 187 758 Q 187.5 774.6 198.5 782 Q 208.9 789.1 228.5 787 Q 241.2 785.2 247 776.5 Q 250.1 772.1 249 763.5 L 242.5 753 L 226.5 746 L 186.5 735 Q 172.3 729.7 164 718.5 Q 154.6 707.4 156 685.5 Q 159.8 666.3 172.5 656 Q 186.5 644 208.5 640 Z "/><path fill="rgb(246,246,245)" stroke="rgb(246,246,245)" stroke-width="0" opacity="0.996078431372549" d="M 524.5 640 Q 571.5 637 592 660.5 Q 604.3 673.2 609 693.5 L 574 698 Q 571.2 684.6 560.5 678 Q 550.3 670.2 531.5 671 Q 513.2 673.7 505 686.5 Q 491.2 703.2 493 735.5 Q 495.4 765.1 513.5 779 Q 525.4 790.1 551.5 787 Q 567.7 783.2 576 771.5 L 576 749 L 541 749 L 541 721 L 609 721 L 609 781.5 Q 602.4 794.4 591.5 803 Q 570.4 820.4 530.5 819 Q 495.2 814.8 477 793.5 Q 452 768.5 455 715.5 Q 459.8 675.3 485.5 656 Q 500.3 643.3 524.5 640 Z "/><path fill="rgb(246,246,245)" stroke="rgb(246,246,245)" stroke-width="0" opacity="0.996078431372549" d="M 293.5 642 L 334 643 L 374 778 Q 377.3 779.3 376 774.5 L 417 643 L 456.5 642 L 457 644.5 L 398.5 815 L 351.5 815 L 351 813.5 L 293.5 642 Z "/><path fill="rgb(246,246,245)" stroke="rgb(246,246,245)" stroke-width="0" opacity="0.996078431372549" d="M 680.5 685 Q 718.8 682.7 734 703.5 Q 750 721.8 746 759 L 661.5 759 L 661 763.5 Q 663.2 778.3 673.5 785 Q 681.1 790.9 696.5 789 Q 707.2 786.7 712 778.5 L 714.5 774 L 745 775 Q 741.2 795.9 726.5 807 Q 712.4 819.9 684.5 819 Q 657.2 815.8 643 799.5 Q 626.5 781.5 627 746.5 Q 629.5 714.5 648.5 699 Q 660.5 688 680.5 685 Z M 683 711 L 669 718 L 662 734 L 663 737 L 713 737 Q 714 725 708 719 Q 701 709 683 711 Z "/><path fill="rgb(246,246,245)" stroke="rgb(246,246,245)" stroke-width="0" opacity="0.996078431372549" d="M 831.5 685 Q 857.4 684.6 868 699.5 Q 877.7 710.8 878 731.5 L 878 815 L 843 815 L 843 730.5 L 838 719 Q 831.9 711.8 815.5 714 Q 806.4 716.4 802 723.5 L 798 735.5 L 798 815 L 764.5 815 L 764 814.5 L 764 687 L 798 687 L 798 706.5 L 800 705.5 L 810.5 693 Q 818.3 686.3 831.5 685 Z "/></svg>
      
      <h1>PNG  SVG Tracer & vektoriseringsvrktj</h1>
    </div>

    <p class="description">
      Upload en PNG og generr en redigerbar, detaljeret SVG. Justr detaljeringsgrad og geometrisk udjvning fr konvertering  og finjustr farver/placeringer bagefter. Alt krer lokalt i browseren.
    </p>

    <div class="controls">
      <div class="control">
        <label for="fileInput"><span>PNG-fil</span><span class="badge">Krver PNG</span></label>
        <input id="fileInput" type="file" accept="image/png" />
        <button id="uploadBtn" class="secondary" style="width:100%; margin-top:8px;">Upload</button>
        <div class="hint">Maks ~12 MB anbefales for hurtig konvertering.</div>
      </div>
      <div class="control">
        <label for="detailRange"><span>Detaljeringsgrad</span><span id="detailValue">7</span></label>
        <input id="detailRange" type="range" min="1" max="10" step="1" value="7" />
        <div class="hint">Hjere = flere sm kurver (ltres/qtres), lavere = simplere.</div>
      </div>
      <div class="control">
        <label for="smoothRange"><span>Geometrisk udjvning</span><span id="smoothValue">40%</span></label>
        <input id="smoothRange" type="range" min="0" max="100" step="5" value="40" />
        <div class="hint">Styrer blur og form-udglatning fr sporingen.</div>
      </div>
      <div class="control">
        <label for="colorsRange"><span>Farvepalet</span><span id="colorsValue">64 farver</span></label>
        <input id="colorsRange" type="range" min="0" max="512" step="1" value="64" />
        <div class="inline-flex" style="gap:10px; align-items:center; margin-top:8px; width:100%;">
          <input id="colorsNumber" type="number" min="0" max="512" step="1" value="64" style="flex:1;" />
          <span class="hint" style="margin:0;">Skriv eller brug pilene for 1</span>
        </div>
        <div id="colorsWarning" class="hint hidden" style="margin-top:6px;"></div>
        <label style="margin-top:6px; gap:10px; align-items:center; display:flex;">
          <input id="matchPalette" type="checkbox" />
          <span>Match inputfilens palet (krver upload)</span>
        </label>
        <label style="margin-top:6px; gap:10px; align-items:center; display:flex;">
          <input id="gradientToggle" type="checkbox" />
          <span>Bevar gradienter (ger farvebudget og sampling)</span>
        </label>
        <div class="hint">0 = auto (bruger hele paletten fra input). Med matchet palet kan du vlge 0 til inputfarverne (uanset strrelse); uden match kan du vlge 0-512.</div>
      </div>
    </div>

    <div class="actions">
      <button id="convertBtn">Konvertr til SVG</button>
      <button id="downloadBtn" class="secondary" disabled>Download SVG</button>
      <button id="resetViewBtn" class="secondary">Nulstil visning</button>
      <span class="inline-flex" style="flex-wrap:wrap; gap:6px; align-items:center;">
        <label for="exportWidth" style="margin:0;">Outputstrrelse (px)</label>
        <input id="exportWidth" type="number" min="1" step="1" value="1024" style="width:90px;" />
        <span style="color:var(--muted);"></span>
        <input id="exportHeight" type="number" min="1" step="1" value="1024" style="width:90px;" />
        <label style="display:flex; align-items:center; gap:6px; margin:0;">
          <input id="lockAspect" type="checkbox" checked />
          <span>Ls hjde/bredde-forhold</span>
        </label>
      </span>
    </div>

    <div class="effect-grid">
      <div class="effect-cell">
        <label for="glowRange">Feather/outer glow (<span id="glowValue">0 px</span>)</label>
        <div class="effect-control">
          <input id="glowRange" type="range" min="0" max="50" step="1" value="0" />
          <input id="glowNumber" type="number" min="0" max="50" step="1" value="0" />
          <input id="glowColor" class="swatch" type="color" value="#00ffff" />
        </div>
      </div>
      <div class="effect-cell">
        <label for="outlineRange">Outline (<span id="outlineValue">0 px</span>)</label>
        <div class="effect-control">
          <input id="outlineRange" type="range" min="0" max="50" step="1" value="0" />
          <input id="outlineNumber" type="number" min="0" max="50" step="1" value="0" />
          <input id="outlineColor" class="swatch" type="color" value="#00ffff" />
        </div>
      </div>
      <div class="effect-cell">
        <label for="innerGlowRange">Inner glow (<span id="innerGlowValue">0 px</span>)</label>
        <div class="effect-control">
          <input id="innerGlowRange" type="range" min="0" max="50" step="1" value="0" />
          <input id="innerGlowNumber" type="number" min="0" max="50" step="1" value="0" />
          <input id="innerGlowColor" class="swatch" type="color" value="#ffffff" />
        </div>
      </div>
      <div class="effect-cell">
        <label for="innerFillColor">Inner fill (<span id="innerFillOpacityValue">0%</span>)</label>
        <div class="effect-control">
          <input id="innerFillColor" class="swatch" type="color" value="#ffffff" />
          <input id="innerFillOpacityRange" type="range" min="0" max="100" step="1" value="0" />
          <input id="innerFillOpacityNumber" type="number" min="0" max="100" step="1" value="0" />
        </div>
      </div>
    </div>

    <div class="actions">
      <span class="inline-flex" style="flex-wrap:wrap; gap:6px; align-items:center;">
        <label for="bgColorPicker" style="margin:0;">Baggrund  transparent</label>
        <input id="bgColorPicker" class="swatch" type="color" value="#000000" />
        <button id="sampleBgBtn" class="secondary" style="padding:8px 12px;">Vlg fra PNG</button>
        <button id="applyBgRemovalBtn" class="secondary" style="padding:8px 12px;">Fjern baggrund</button>
      </span>
      <span class="inline-flex">
        <label for="colorPicker" style="margin:0;">Redigr farve</label>
        <input id="colorPicker" class="swatch" type="color" value="#00ffff" disabled />
      </span>
      <span class="inline-flex">
        <label for="transparentPicker" style="margin:0;">Gr farve transparent</label>
        <input id="transparentPicker" class="swatch" type="color" value="#000000" disabled />
        <button id="makeTransparentBtn" class="secondary" disabled style="padding:8px 12px;">Anvend</button>
      </span>
    </div>

    <div class="actions" style="flex-wrap:wrap;">
      <button id="deleteBtn" class="secondary" disabled>Slet valgte</button>
      <button id="rotateLeftBtn" class="secondary" disabled>Rotr -15</button>
      <button id="rotateRightBtn" class="secondary" disabled>Rotr +15</button>
      <button id="flipHBtn" class="secondary" disabled>Spejlvend horisontalt</button>
      <button id="flipVBtn" class="secondary" disabled>Spejlvend vertikalt</button>
      <button id="alignLeftBtn" class="secondary" disabled>Align venstre</button>
      <button id="alignCenterBtn" class="secondary" disabled>Align center</button>
      <button id="alignRightBtn" class="secondary" disabled>Align hjre</button>
      <button id="alignTopBtn" class="secondary" disabled>Align top</button>
      <button id="alignMiddleBtn" class="secondary" disabled>Align midte</button>
      <button id="alignBottomBtn" class="secondary" disabled>Align bund</button>
      <span class="badge">Tip: Klik et SVG-objekt for at markere og trkke i det. Marker flere elementer med Ctrl/ eller Shift for alignment.</span>
    </div>

    <div class="status" id="status"></div>

    <div class="panels">
      <div class="panel">
        <h2>Input preview</h2>
        <div class="viewport" id="previewViewport">
          <div class="viewport-inner" id="previewInner">
            <canvas id="previewCanvas" width="10" height="10" style="width:100%;height:auto;"></canvas>
          </div>
        </div>
        <div class="hint">Forvisning af PNG'en der spores (skaleres automatisk til canvas-strrelse). Zoom med musehjulet og panorr ved at holde venstre musetast nede  udsnittet spejles automatisk til SVG-visningen.</div>
      </div>
      <div class="panel">
        <h2>SVG</h2>
        <div id="svgOutput" aria-live="polite">
          <div class="viewport" id="svgViewport">
            <div class="viewport-inner" id="svgInner"></div>
            <div class="selection-overlay" id="selectionOverlay"></div>
          </div>
        </div>
      </div>
      <div class="panel">
        <h2>Log & hjlp</h2>
        <div class="hint">
          <ul>
            <li>Kontrollr at filen er PNG. Andre formater afvises for at undg fejl.</li>
            <li>Brug "Detaljeringsgrad" til at balancere prcision vs. filstrrelse.</li>
            <li>"Geometrisk udjvning" justerer blur og simplificering fr sporingen.</li>
            <li>Klik p et SVG-element for at vlge det. Brug farvevlgeren til at ndre fill, og trk for at flytte.</li>
            <li>Download-knappen aktiveres efter en succesfuld konvertering.</li>
            <li>Zoom og panorr kun i PNG-previewet (venstreklik+trk for pan); udsnittet spejles automatisk til SVG-visningen.</li>
            <li>Hold Shift nede og trk i SVG-visningen for at markere flere elementer med en ramme.</li>
            <li>Brug "Vlg fra PNG" + "Fjern baggrund" til at gre baggrunden transparent, og angiv outputstrrelse/forhold fr download.</li>
          </ul>
        </div>
      </div>
    </div>
  </main>

  <script>
    const fileInput = document.getElementById('fileInput');
    const detailRange = document.getElementById('detailRange');
    const smoothRange = document.getElementById('smoothRange');
    const colorsRange = document.getElementById('colorsRange');
    const colorsNumber = document.getElementById('colorsNumber');
    const colorsWarning = document.getElementById('colorsWarning');
    const gradientToggle = document.getElementById('gradientToggle');
    const matchPalette = document.getElementById('matchPalette');
    const detailValue = document.getElementById('detailValue');
    const smoothValue = document.getElementById('smoothValue');
    const colorsValue = document.getElementById('colorsValue');
    const uploadBtn = document.getElementById('uploadBtn');
    const convertBtn = document.getElementById('convertBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const resetViewBtn = document.getElementById('resetViewBtn');
    const svgOutput = document.getElementById('svgOutput');
    const svgInner = document.getElementById('svgInner');
    const svgViewport = document.getElementById('svgViewport');
    const statusEl = document.getElementById('status');
    const colorPicker = document.getElementById('colorPicker');
    const transparentPicker = document.getElementById('transparentPicker');
    const makeTransparentBtn = document.getElementById('makeTransparentBtn');
    const previewCanvas = document.getElementById('previewCanvas');
    const previewCtx = previewCanvas.getContext('2d');
    const previewInner = document.getElementById('previewInner');
    const previewViewport = document.getElementById('previewViewport');
    const deleteBtn = document.getElementById('deleteBtn');
    const rotateLeftBtn = document.getElementById('rotateLeftBtn');
    const rotateRightBtn = document.getElementById('rotateRightBtn');
    const flipHBtn = document.getElementById('flipHBtn');
    const flipVBtn = document.getElementById('flipVBtn');
    const alignLeftBtn = document.getElementById('alignLeftBtn');
    const alignCenterBtn = document.getElementById('alignCenterBtn');
    const alignRightBtn = document.getElementById('alignRightBtn');
    const alignTopBtn = document.getElementById('alignTopBtn');
    const alignMiddleBtn = document.getElementById('alignMiddleBtn');
    const alignBottomBtn = document.getElementById('alignBottomBtn');
    const glowRange = document.getElementById('glowRange');
    const glowNumber = document.getElementById('glowNumber');
    const glowValue = document.getElementById('glowValue');
    const glowColor = document.getElementById('glowColor');
    const outlineRange = document.getElementById('outlineRange');
    const outlineNumber = document.getElementById('outlineNumber');
    const outlineValue = document.getElementById('outlineValue');
    const outlineColor = document.getElementById('outlineColor');
    const innerGlowRange = document.getElementById('innerGlowRange');
    const innerGlowNumber = document.getElementById('innerGlowNumber');
    const innerGlowValue = document.getElementById('innerGlowValue');
    const innerGlowColor = document.getElementById('innerGlowColor');
    const innerFillColor = document.getElementById('innerFillColor');
    const innerFillOpacityRange = document.getElementById('innerFillOpacityRange');
    const innerFillOpacityNumber = document.getElementById('innerFillOpacityNumber');
    const innerFillOpacityValue = document.getElementById('innerFillOpacityValue');
    const bgColorPicker = document.getElementById('bgColorPicker');
    const sampleBgBtn = document.getElementById('sampleBgBtn');
    const applyBgRemovalBtn = document.getElementById('applyBgRemovalBtn');
    const exportWidth = document.getElementById('exportWidth');
    const exportHeight = document.getElementById('exportHeight');
    const lockAspect = document.getElementById('lockAspect');
    const selectionOverlay = document.getElementById('selectionOverlay');

    function tracerIsReady() {
      return (
        typeof ImageTracer === 'object' &&
        ImageTracer !== null &&
        typeof ImageTracer.imagedataToSVG === 'function'
      );
    }

    let tracerReady = tracerIsReady();

    let lastSVG = '';
    let selectedElements = [];
    let dragOrigin = null;
    let inputPaletteSize = null;
    let editingListenersBound = false;
    let cachedImageData = null;
    let cachedImageSignature = null;
    let currentFileBase = 'vectorized';
    let originalDimensions = { width: 1024, height: 1024 };
    let backgroundPickMode = false;
    let boxSelectState = null;

    function captureCurrentSVG() {
      const svgEl = svgOutput.querySelector('svg');
      if (!svgEl) return;
      lastSVG = new XMLSerializer().serializeToString(svgEl);
    }

    const MAX_BYTES = 12 * 1024 * 1024; // ~12MB
    const DEFAULT_MAX_COLORS = 512;
    const MIN_SCALE = 0.25;
    const MAX_SCALE = 6;
    const SVG_NS = 'http://www.w3.org/2000/svg';
    const GLOW_FILTER_ID = 'outer-glow-filter';
    const viewportState = { scale: 1, x: 0, y: 0 };
    let isPanning = false;
    let panOrigin = null;
    let spaceHeld = false;
    let viewportListenersBound = false;
    let aspectRatio = 1;
    let exportManualChange = false;

    function computePaletteSize(imageData) {
      const { data } = imageData;
      const seen = new Set();
      for (let i = 0; i < data.length; i += 4) {
        const alpha = data[i + 3];
        if (alpha === 0) continue;
        const key = `${data[i]},${data[i + 1]},${data[i + 2]}`;
        seen.add(key);
      }
      return seen.size;
    }

    function fileSignature(file) {
      return file ? `${file.name}-${file.size}-${file.lastModified}` : null;
    }

    function updateLabels() {
      detailValue.textContent = detailRange.value;
      smoothValue.textContent = `${smoothRange.value}%`;
      colorsNumber.value = colorsRange.value;
      colorsValue.textContent =
        colorsRange.value === '0'
          ? `Auto (0-${colorsRange.max} farver)`
          : `${colorsRange.value} farver`;
    }

    function paletteWarningState(value) {
      const warnOrange = value > 128 && value <= 256;
      const warnRed = value > 256;

      colorsRange.classList.toggle('warn-orange', warnOrange && !warnRed);
      colorsRange.classList.toggle('warn-red', warnRed);

      let message = '';
      if (warnRed) {
        message = 'Stor palet (>256) kan give meget lang behandlingstid og potentielt nedbrud.';
        colorsWarning.style.color = '#fca5a5';
      } else if (warnOrange) {
        message = 'Stor palet (>128) kan tage lang tid at spore.';
        colorsWarning.style.color = '#fdba74';
      }

      colorsWarning.textContent = message;
      colorsWarning.classList.toggle('hidden', !message);
    }

    updateLabels();
    paletteWarningState(Number(colorsRange.value));
    syncGlow(Number(glowRange.value));

    function clearCachedImage() {
      cachedImageData = null;
      cachedImageSignature = null;
      inputPaletteSize = null;
      refreshColorBounds();
    }

    function currentColorMax() {
      if (matchPalette.checked && inputPaletteSize) {
        return Math.max(0, inputPaletteSize);
      }
      return DEFAULT_MAX_COLORS;
    }

    function clampColorValue(value, maxOverride) {
      const max = Math.max(0, maxOverride ?? currentColorMax());
      if (!Number.isFinite(value)) return 0;
      return Math.min(Math.max(0, Math.round(value)), max);
    }

    function applyColorValue(value) {
      const clamped = clampColorValue(value);
      colorsRange.value = String(clamped);
      colorsNumber.value = String(clamped);
      updateLabels();
      paletteWarningState(clamped);
    }

    function refreshColorBounds() {
      const max = currentColorMax();
      colorsRange.max = String(max);
      colorsNumber.max = String(max);
      applyColorValue(Number(colorsRange.value));
    }

    [detailRange, smoothRange].forEach((el) => {
      el.addEventListener('input', updateLabels);
    });

    colorsRange.addEventListener('input', () => {
      applyColorValue(Number(colorsRange.value));
    });

    colorsNumber.addEventListener('input', () => {
      applyColorValue(Number(colorsNumber.value));
    });

    refreshColorBounds();

    exportWidth.addEventListener('input', () => {
      exportManualChange = true;
      const width = clampDimension(exportWidth.value, originalDimensions.width || 1024);
      if (!lockAspect.checked) {
        const height = clampDimension(exportHeight.value, originalDimensions.height || 1024);
        aspectRatio = height > 0 ? width / height : aspectRatio;
      }
      syncExportFromWidth(width);
    });

    exportHeight.addEventListener('input', () => {
      exportManualChange = true;
      const height = clampDimension(exportHeight.value, originalDimensions.height || 1024);
      if (!lockAspect.checked) {
        const width = clampDimension(exportWidth.value, originalDimensions.width || 1024);
        aspectRatio = height > 0 ? width / height : aspectRatio;
      }
      syncExportFromHeight(height);
    });

    lockAspect.addEventListener('change', () => {
      const width = clampDimension(exportWidth.value, originalDimensions.width || 1024);
      const height = clampDimension(exportHeight.value, originalDimensions.height || 1024);
      aspectRatio = height > 0 ? width / height : aspectRatio;
      if (lockAspect.checked) {
        syncExportFromWidth(width);
      }
    });

    uploadBtn.addEventListener('click', async (event) => {
      event.preventDefault();
      const file = fileInput.files?.[0];
      if (!file) {
        fileInput.click();
        return;
      }
      await loadImageFromFile(file).catch(() => {});
    });

    fileInput.addEventListener('change', () => {
      clearCachedImage();
      lastSVG = '';
      svgInner.replaceChildren();
      downloadBtn.disabled = true;
      clearSelection();
      updateEditControls();
      backgroundPickMode = false;
      if (fileInput.files?.[0]) {
        setStatus('Fil valgt. Klik Upload for at indlse previewet eller konvertr til SVG.');
      }
    });

    matchPalette.addEventListener('change', () => {
      if (matchPalette.checked) {
        if (!inputPaletteSize) {
          setStatus('Upload en PNG for at kunne matche dens palet.', true);
          matchPalette.checked = false;
          refreshColorBounds();
          return;
        }
        refreshColorBounds();
        applyColorValue(inputPaletteSize);
        setStatus(`Matchede paletstrrelse fra input (${inputPaletteSize} farver).`);
      } else {
        refreshColorBounds();
        setStatus('Paletmatch slet fra. Intervallet er 0-512 farver.');
      }
    });

    updateEditControls();

    function setStatus(message, isError = false) {
      statusEl.textContent = message;
      statusEl.style.color = isError ? '#fda4af' : 'var(--muted)';
    }

    function applyViewport() {
      const transform = `translate(${viewportState.x}px, ${viewportState.y}px) scale(${viewportState.scale})`;
      [previewInner, svgInner].forEach((el) => {
        if (el) {
          el.style.transform = transform;
        }
      });
    }

    function resetViewport() {
      viewportState.scale = 1;
      viewportState.x = 0;
      viewportState.y = 0;
      applyViewport();
    }

    function zoomAt(container, clientX, clientY, factor) {
      const rect = container.getBoundingClientRect();
      const cx = clientX - (rect.left + rect.width / 2);
      const cy = clientY - (rect.top + rect.height / 2);
      const prevScale = viewportState.scale;
      const nextScale = Math.min(MAX_SCALE, Math.max(MIN_SCALE, prevScale * factor));
      const ratio = nextScale / prevScale;
      viewportState.x = cx + (viewportState.x - cx) * ratio;
      viewportState.y = cy + (viewportState.y - cy) * ratio;
      viewportState.scale = nextScale;
      applyViewport();
    }

    function bindViewportInteractions(container) {
      if (!container) return;
      container.addEventListener('wheel', (event) => {
        event.preventDefault();
        const factor = event.deltaY < 0 ? 1.1 : 0.9;
        zoomAt(container, event.clientX, event.clientY, factor);
      }, { passive: false });

      container.addEventListener('contextmenu', (event) => event.preventDefault());

      container.addEventListener('mousedown', (event) => {
        const isPrimary = event.button === 0;
        if (!isPrimary) return;
        if (backgroundPickMode && container === previewViewport) {
          event.preventDefault();
          pickBackgroundFromEvent(event);
          backgroundPickMode = false;
          return;
        }
        event.preventDefault();
        isPanning = true;
        panOrigin = {
          startX: event.clientX,
          startY: event.clientY,
          x: viewportState.x,
          y: viewportState.y,
        };
        container.classList.add('dragging');
      });

      if (!viewportListenersBound) {
        window.addEventListener('mousemove', (event) => {
          if (!isPanning || !panOrigin) return;
          const dx = event.clientX - panOrigin.startX;
          const dy = event.clientY - panOrigin.startY;
          viewportState.x = panOrigin.x + dx;
          viewportState.y = panOrigin.y + dy;
          applyViewport();
        });

        const stopPan = () => {
          isPanning = false;
          panOrigin = null;
          previewViewport.classList.remove('dragging');
          svgViewport.classList.remove('dragging');
        };

        window.addEventListener('mouseup', stopPan);
        window.addEventListener('mouseleave', stopPan);
        viewportListenersBound = true;
      }
    }

    window.addEventListener('keydown', (event) => {
      if (event.code === 'Space') {
        spaceHeld = true;
      }
    });

    window.addEventListener('keyup', (event) => {
      if (event.code === 'Space') {
        spaceHeld = false;
      }
    });

    bindViewportInteractions(previewViewport);
    applyViewport();

    svgViewport.addEventListener('mousedown', (event) => {
      const svgEl = svgOutput.querySelector('svg');
      if (!svgEl) return;
      if (!event.shiftKey || event.button !== 0) return;
      event.preventDefault();
      const rect = svgViewport.getBoundingClientRect();
      boxSelectState = {
        startX: event.clientX,
        startY: event.clientY,
        additive: event.ctrlKey || event.metaKey || event.shiftKey,
      };
      updateSelectionOverlay({ x: event.clientX - rect.left, y: event.clientY - rect.top, width: 0, height: 0 });
    });

    window.addEventListener('mousemove', (event) => {
      if (!boxSelectState) return;
      event.preventDefault();
      const rect = svgViewport.getBoundingClientRect();
      const left = Math.min(boxSelectState.startX, event.clientX);
      const top = Math.min(boxSelectState.startY, event.clientY);
      const right = Math.max(boxSelectState.startX, event.clientX);
      const bottom = Math.max(boxSelectState.startY, event.clientY);
      updateSelectionOverlay({ x: left - rect.left, y: top - rect.top, width: right - left, height: bottom - top });
    });

    const finishBoxSelection = (event) => {
      if (!boxSelectState) return;
      const svgEl = svgOutput.querySelector('svg');
      const { startX, startY, additive } = boxSelectState;
      boxSelectState = null;
      updateSelectionOverlay(null);
      if (!svgEl) return;

      const left = Math.min(startX, event.clientX);
      const top = Math.min(startY, event.clientY);
      const right = Math.max(startX, event.clientX);
      const bottom = Math.max(startY, event.clientY);

      const nodes = svgEl.querySelectorAll('path, rect, circle, ellipse, polygon, polyline, g');
      const hits = Array.from(nodes).filter((node) => {
        if (!(node instanceof SVGElement)) return false;
        const rect = node.getBoundingClientRect();
        return !(rect.right < left || rect.left > right || rect.bottom < top || rect.top > bottom);
      });

      applyGroupSelection(hits, additive);
      setStatus(
        hits.length > 0
          ? `Markerede ${hits.length} element(er) med markrramme.`
          : 'Ingen elementer fanget af markrrammen.',
      );
    };

    window.addEventListener('mouseup', finishBoxSelection);
    window.addEventListener('mouseleave', finishBoxSelection);

    resetViewBtn.addEventListener('click', () => {
      resetViewport();
      setStatus('Visning nulstillet for begge canvasser.');
    });

    window.addEventListener('load', () => {
      tracerReady = tracerIsReady();
      if (!tracerReady) {
        setStatus(
          'ImageTracer blev ikke indlst lokalt. Forsger automatisk online fallback ',
          true,
        );
        loadTracerFallback().then((ready) => {
          tracerReady = ready;
          if (ready) {
            setStatus('ImageTracer indlst via fallback. Upload en PNG for at starte.');
          } else {
            setStatus(
              'ImageTracer kunne ikke indlses. Srg for at vendor/imagetracer_v1.2.6.js er tilgngelig eller tjek internetforbindelsen.',
              true,
            );
          }
        });
      } else {
        setStatus('ImageTracer klar. Upload en PNG for at starte.');
      }
    });

    function ensurePNG(file) {
      if (!file) {
        setStatus('Vlg venligst en PNG-fil.');
        return false;
      }
      if (file.type !== 'image/png') {
        setStatus('Kun PNG-filer understttes for at sikre korrekt vektorisering.', true);
        return false;
      }
      if (file.size > MAX_BYTES) {
        setStatus('Filen er stor. Prv en mindre PNG (<12 MB) for hurtigere resultat.', true);
        return false;
      }
      return true;
    }

    function mapOptions() {
      const detail = Number(detailRange.value); // 1-10
      const smooth = Number(smoothRange.value) / 100; // 0-1
      const colors = Number(colorsRange.value);
      const gradientAware = gradientToggle.checked;

      // Tighter thresholds for more detaljer: ltres/qtres lower => more points
      const ltres = 2 - (detail - 1) * 0.18; // from ~2 to ~0.2
      const qtres = 2 - (detail - 1) * 0.19; // from ~2 to ~0.1
      const pathomit = Math.max(0, 25 - detail * 2.2); // drop tiny paths when low detail

      // Geometric smoothing toggles a light blur before tracing
      const blurradius = smooth * 1.4; // 0 - 1.4
      const blurdelta = Math.max(0.05, 0.35 - smooth * 0.25);

      const colorBudget = colors === 0 ? Math.max(1, inputPaletteSize || 64) : colors;

      return {
        ltres: Math.max(0.05, ltres),
        qtres: Math.max(0.02, qtres),
        pathomit,
        rightangleenhance: true,
        linefilter: true,
        numberofcolors: colorBudget,
        mincolorratio: gradientAware ? 0.002 : 0.02,
        colorquantcycles: gradientAware ? 12 : 4,
        colorsampling: gradientAware ? 2 : 1,
        layering: gradientAware ? 1 : 0,
        blurradius,
        blurdelta,
        strokewidth: 0,
        scale: 1,
      };
    }

    function rgbaToHex(r, g, b) {
      const clamp = (v) => Math.max(0, Math.min(255, Math.round(v)));
      return `#${[clamp(r), clamp(g), clamp(b)]
        .map((v) => v.toString(16).padStart(2, '0'))
        .join('')}`;
    }

    function samplePixel(imageData, x = 0, y = 0) {
      if (!imageData) return null;
      const { width, height, data } = imageData;
      const cx = Math.min(width - 1, Math.max(0, Math.round(x)));
      const cy = Math.min(height - 1, Math.max(0, Math.round(y)));
      const idx = (cy * width + cx) * 4;
      return {
        hex: rgbaToHex(data[idx], data[idx + 1], data[idx + 2]),
        alpha: data[idx + 3],
      };
    }

    function detectBackgroundColor(imageData) {
      if (!imageData) return null;
      const samples = [
        samplePixel(imageData, 0, 0),
        samplePixel(imageData, imageData.width - 1, 0),
        samplePixel(imageData, 0, imageData.height - 1),
        samplePixel(imageData, imageData.width - 1, imageData.height - 1),
      ].filter((s) => s && s.alpha > 0);

      if (samples.length === 0) return '#000000';

      const avg = samples.reduce(
        (acc, s) => ({
          r: acc.r + parseInt(s.hex.slice(1, 3), 16),
          g: acc.g + parseInt(s.hex.slice(3, 5), 16),
          b: acc.b + parseInt(s.hex.slice(5, 7), 16),
        }),
        { r: 0, g: 0, b: 0 },
      );
      const count = samples.length;
      return rgbaToHex(avg.r / count, avg.g / count, avg.b / count);
    }

    function clampDimension(value, fallback) {
      const num = Number(value);
      if (!Number.isFinite(num) || num <= 0) return fallback;
      return Math.max(1, Math.round(num));
    }

    function syncExportFromWidth(width) {
      const safeWidth = clampDimension(width, originalDimensions.width || 1024);
      if (lockAspect.checked && aspectRatio > 0) {
        const nextHeight = Math.max(1, Math.round(safeWidth / aspectRatio));
        exportHeight.value = String(nextHeight);
      }
      exportWidth.value = String(safeWidth);
    }

    function syncExportFromHeight(height) {
      const safeHeight = clampDimension(height, originalDimensions.height || 1024);
      if (lockAspect.checked && aspectRatio > 0) {
        const nextWidth = Math.max(1, Math.round(safeHeight * aspectRatio));
        exportWidth.value = String(nextWidth);
      }
      exportHeight.value = String(safeHeight);
    }

    function setExportDefaults(width, height) {
      const safeW = clampDimension(width, 1024);
      const safeH = clampDimension(height, 1024);
      aspectRatio = safeH === 0 ? 1 : safeW / safeH;
      originalDimensions = { width: safeW, height: safeH };
      exportManualChange = false;
      exportWidth.value = String(safeW);
      exportHeight.value = String(safeH);
    }

    async function loadImageFromFile(file, { silentStatus = false } = {}) {
      if (!ensurePNG(file) || !previewCtx) {
        throw new Error('Ugyldig PNG');
      }

      const signature = fileSignature(file);
      currentFileBase = file.name ? file.name.replace(/\.[^.]+$/, '') : 'vectorized';

      return new Promise((resolve, reject) => {
        if (!silentStatus) {
          setStatus('Indlser fil ');
        }

        const reader = new FileReader();

        reader.onload = () => {
          const dataUrl = typeof reader.result === 'string' ? reader.result : '';
          if (!dataUrl) {
            setStatus('Kunne ikke lse filen.', true);
            reject(new Error('Lsning fejlede'));
            return;
          }

          const img = new Image();
          img.onload = () => {
            const maxDim = 1024;
            const scale = Math.min(1, maxDim / Math.max(img.width, img.height));
            const width = Math.max(1, Math.round(img.width * scale));
            const height = Math.max(1, Math.round(img.height * scale));

            setExportDefaults(img.width, img.height);

            previewCanvas.width = width;
            previewCanvas.height = height;
            previewCtx.clearRect(0, 0, width, height);
            previewCtx.drawImage(img, 0, 0, width, height);

            const imageData = previewCtx.getImageData(0, 0, width, height);
            cachedImageData = imageData;
            cachedImageSignature = signature;
            inputPaletteSize = computePaletteSize(imageData);
            const bgGuess = detectBackgroundColor(imageData);
            if (bgGuess) {
              bgColorPicker.value = bgGuess;
            }
            refreshColorBounds();

            if (inputPaletteSize) {
              const baseMessage = `Opdagede ${inputPaletteSize} unikke farver i input.`;
              if (matchPalette.checked) {
                applyColorValue(inputPaletteSize);
                setStatus(`${baseMessage} Spndet matcher nu input-paletten (0-${inputPaletteSize}).`);
              } else {
                setStatus(`${baseMessage} Spndet forbliver 0-${colorsRange.max} med mindre du matcher paletten.`);
              }
            } else if (!silentStatus) {
              setStatus('PNG indlst. Klar til konvertering.');
            }

            resetViewport();
            resolve(imageData);
          };

          img.onerror = () => {
            setStatus('Kunne ikke indlse billedet. Kontroller at filen er en gyldig PNG.', true);
            reject(new Error('PNG load fejlede'));
          };

          img.src = dataUrl;
        };

        reader.onerror = () => {
          setStatus('Kunne ikke lse filen.', true);
          reject(new Error('Fil-lsning fejlede'));
        };

        reader.readAsDataURL(file);
      });
    }

    async function ensureImageData() {
      const file = fileInput.files?.[0];
      if (!ensurePNG(file) || !previewCtx) return null;

      const signature = fileSignature(file);
      if (cachedImageData && cachedImageSignature === signature) {
        return cachedImageData;
      }

      try {
        const data = await loadImageFromFile(file);
        return data;
      } catch (error) {
        console.error(error);
        return null;
      }
    }

    function pickBackgroundFromEvent(event) {
      if (!cachedImageData) {
        setStatus('Upload og indls en PNG fr du sampler baggrundsfarven.', true);
        return;
      }
      const rect = previewCanvas.getBoundingClientRect();
      if (!rect.width || !rect.height) return;
      const relX = ((event.clientX - rect.left) / rect.width) * cachedImageData.width;
      const relY = ((event.clientY - rect.top) / rect.height) * cachedImageData.height;
      const sample = samplePixel(cachedImageData, relX, relY);
      if (sample) {
        bgColorPicker.value = sample.hex;
        setStatus(`Valgte baggrundsfarve ${sample.hex} fra PNG. Klik "Fjern baggrund" for at gre den transparent.`);
      }
    }

    function loadTracerFallback() {
      return new Promise((resolve) => {
        if (tracerIsReady()) {
          resolve(true);
          return;
        }

        const existing = document.getElementById('imagetracer-cdn');
        if (existing) {
          existing.addEventListener('load', () => resolve(tracerIsReady()));
          existing.addEventListener('error', () => resolve(false));
          return;
        }

        const script = document.createElement('script');
        script.id = 'imagetracer-cdn';
        script.src = 'https://unpkg.com/imagetracerjs@1.2.6/imagetracer_v1.2.6.js';
        script.crossOrigin = 'anonymous';
        script.referrerPolicy = 'no-referrer';
        script.onload = () => resolve(tracerIsReady());
        script.onerror = () => resolve(false);
        document.head.appendChild(script);
      });
    }

    async function ensureTracer() {
      tracerReady = tracerIsReady();
      if (tracerReady) return true;

      setStatus('Forsger at hente ImageTracer online ');
      const loaded = await loadTracerFallback();
      tracerReady = loaded;
      if (loaded) return true;

      setStatus(
        'ImageTracer kunne ikke initialiseres. Tjek at vendor/imagetracer_v1.2.6.js ligger ved siden af denne HTML og at der er internetadgang til fallback.',
        true,
      );
      return false;
    }

    function updateEditControls() {
      const hasSelection = selectedElements.length > 0;
      const multiSelect = selectedElements.length > 1;

      [deleteBtn, rotateLeftBtn, rotateRightBtn, flipHBtn, flipVBtn].forEach((btn) => {
        btn.disabled = !hasSelection;
      });

      [alignLeftBtn, alignCenterBtn, alignRightBtn, alignTopBtn, alignMiddleBtn, alignBottomBtn].forEach((btn) => {
        btn.disabled = !multiSelect;
      });

      colorPicker.disabled = !hasSelection;
      transparentPicker.disabled = !svgOutput.querySelector('svg');
      makeTransparentBtn.disabled = !svgOutput.querySelector('svg');
    }

    function clearSelection() {
      selectedElements.forEach((el) => {
        el.style.outline = '';
      });
      selectedElements = [];
      updateEditControls();
    }

    function syncColorPickerToSelection() {
      const lastSelected = selectedElements[selectedElements.length - 1];
      if (lastSelected) {
        const fill = lastSelected.getAttribute('fill');
        if (fill && fill !== 'none') {
          colorPicker.value = toHex(fill) || colorPicker.value;
        }
      }
    }

    function applySelection(target, additive) {
      if (!additive) clearSelection();
      if (selectedElements.includes(target)) {
        if (additive) {
          target.style.outline = '';
          selectedElements = selectedElements.filter((el) => el !== target);
        }
      } else {
        target.style.outline = '1px solid #38bdf8';
        selectedElements.push(target);
      }
      syncColorPickerToSelection();
      updateEditControls();
    }

    function applyGroupSelection(targets, additive) {
      if (!additive) {
        clearSelection();
      }
      targets.forEach((target) => {
        if (!selectedElements.includes(target)) {
          target.style.outline = '1px solid #38bdf8';
          selectedElements.push(target);
        }
      });
      syncColorPickerToSelection();
      updateEditControls();
    }

    function updateSelectionOverlay(box) {
      if (!selectionOverlay) return;
      if (!box) {
        selectionOverlay.style.display = 'none';
        selectionOverlay.style.width = '0px';
        selectionOverlay.style.height = '0px';
        return;
      }
      selectionOverlay.style.display = 'block';
      selectionOverlay.style.left = `${box.x}px`;
      selectionOverlay.style.top = `${box.y}px`;
      selectionOverlay.style.width = `${box.width}px`;
      selectionOverlay.style.height = `${box.height}px`;
    }

    function getTransformState(el) {
      const tx = Number(el.dataset.tx || '0');
      const ty = Number(el.dataset.ty || '0');
      const rot = Number(el.dataset.rot || '0');
      const sx = Number(el.dataset.sx || '1');
      const sy = Number(el.dataset.sy || '1');
      return { tx, ty, rot, sx, sy };
    }

    function setTransformState(el, state) {
      const { tx, ty, rot, sx, sy } = state;
      el.dataset.tx = tx;
      el.dataset.ty = ty;
      el.dataset.rot = rot;
      el.dataset.sx = sx;
      el.dataset.sy = sy;
      el.setAttribute('transform', `translate(${tx} ${ty}) rotate(${rot}) scale(${sx} ${sy})`);
    }

    function attachEditing(svgRoot) {
      svgRoot.addEventListener('click', (event) => {
        if (!(event.target instanceof SVGElement)) return;
        const additive = event.shiftKey || event.metaKey || event.ctrlKey;
        applySelection(event.target, additive);
      });

      svgRoot.addEventListener('mousedown', (event) => {
        if (spaceHeld) return;
        if (!(event.target instanceof SVGElement)) return;
        const primary = selectedElements[0];
        if (!primary || event.target !== primary) return;
        const { clientX, clientY } = event;
        const { tx, ty } = getTransformState(primary);
        dragOrigin = { clientX, clientY, tx, ty };
      });

      if (!editingListenersBound) {
        window.addEventListener('mousemove', (event) => {
          if (!dragOrigin || selectedElements.length === 0) return;
          event.preventDefault();
          const scale = viewportState.scale || 1;
          const dx = (event.clientX - dragOrigin.clientX) / scale;
          const dy = (event.clientY - dragOrigin.clientY) / scale;
          const primary = selectedElements[0];
          const state = getTransformState(primary);
          const nx = dragOrigin.tx + dx;
          const ny = dragOrigin.ty + dy;
          const newState = { ...state, tx: nx, ty: ny };
          setTransformState(primary, newState);
        });

        window.addEventListener('mouseup', () => {
          if (!dragOrigin) return;
          dragOrigin = null;
          captureCurrentSVG();
        });

        window.addEventListener('keydown', (event) => {
          if (event.key === 'Delete' || event.key === 'Backspace') {
            if (selectedElements.length > 0) {
              event.preventDefault();
              deleteSelected();
            }
          }
        });

        editingListenersBound = true;
      }
    }

    function toHex(color) {
      const ctx = document.createElement('canvas').getContext('2d');
      if (!ctx) return null;
      ctx.fillStyle = color;
      return ctx.fillStyle.match(/^#[0-9a-fA-F]{6}$/) ? ctx.fillStyle : null;
    }

    colorPicker.addEventListener('input', () => {
      if (selectedElements.length === 0) return;
      selectedElements.forEach((el) => {
        el.setAttribute('fill', colorPicker.value);
      });
      captureCurrentSVG();
      setStatus('Opdaterede farve p markerede elementer.');
    });

    makeTransparentBtn.addEventListener('click', () => {
      makeColorTransparent(transparentPicker.value);
    });

    sampleBgBtn.addEventListener('click', () => {
      if (!cachedImageData) {
        setStatus('Upload en PNG fr du vlger baggrundsfarve.', true);
        return;
      }
      backgroundPickMode = true;
      setStatus('Klik i PNG-previewet for at vlge baggrundsfarven.');
    });

    applyBgRemovalBtn.addEventListener('click', () => {
      removeBackgroundByColor(bgColorPicker.value);
    });

    function syncNumeric(value, rangeEl, numberEl, valueEl, suffix, max) {
      const clamped = Math.max(0, Math.min(max, Math.round(value)));
      rangeEl.value = String(clamped);
      numberEl.value = String(clamped);
      if (valueEl) {
        valueEl.textContent = `${clamped}${suffix}`;
      }
      return clamped;
    }

    function syncGlow(value) {
      syncNumeric(value, glowRange, glowNumber, glowValue, ' px', 50);
      applyGlowToSVG();
    }

    function syncOutline(value) {
      syncNumeric(value, outlineRange, outlineNumber, outlineValue, ' px', 50);
      applyGlowToSVG();
    }

    function syncInnerGlow(value) {
      syncNumeric(value, innerGlowRange, innerGlowNumber, innerGlowValue, ' px', 50);
      applyGlowToSVG();
    }

    function syncInnerFillOpacity(value) {
      syncNumeric(value, innerFillOpacityRange, innerFillOpacityNumber, innerFillOpacityValue, '%', 100);
      applyGlowToSVG();
    }

    glowRange.addEventListener('input', () => syncGlow(Number(glowRange.value)));
    glowNumber.addEventListener('input', () => syncGlow(Number(glowNumber.value)));
    glowColor.addEventListener('input', applyGlowToSVG);
    outlineRange.addEventListener('input', () => syncOutline(Number(outlineRange.value)));
    outlineNumber.addEventListener('input', () => syncOutline(Number(outlineNumber.value)));
    outlineColor.addEventListener('input', applyGlowToSVG);
    innerGlowRange.addEventListener('input', () => syncInnerGlow(Number(innerGlowRange.value)));
    innerGlowNumber.addEventListener('input', () => syncInnerGlow(Number(innerGlowNumber.value)));
    innerGlowColor.addEventListener('input', applyGlowToSVG);
    innerFillColor.addEventListener('input', applyGlowToSVG);
    innerFillOpacityRange.addEventListener('input', () =>
      syncInnerFillOpacity(Number(innerFillOpacityRange.value)),
    );
    innerFillOpacityNumber.addEventListener('input', () =>
      syncInnerFillOpacity(Number(innerFillOpacityNumber.value)),
    );

    syncGlow(Number(glowRange.value));
    syncOutline(Number(outlineRange.value));
    syncInnerGlow(Number(innerGlowRange.value));
    syncInnerFillOpacity(Number(innerFillOpacityRange.value));

    function renderSVG(svgString) {
      const parsed = new DOMParser().parseFromString(svgString, 'image/svg+xml');
      const svgEl = parsed.querySelector('svg');
      if (!svgEl) {
        setStatus('Kunne ikke lse SVG-resultatet.', true);
        return;
      }

      const widthAttr = parseFloat(svgEl.getAttribute('width') || '0');
      const heightAttr = parseFloat(svgEl.getAttribute('height') || '0');
      if (!svgEl.getAttribute('viewBox') && widthAttr > 0 && heightAttr > 0) {
        svgEl.setAttribute('viewBox', `0 0 ${widthAttr} ${heightAttr}`);
      }

      svgEl.removeAttribute('width');
      svgEl.removeAttribute('height');
      svgEl.classList.add('svg-canvas');
      svgEl.setAttribute('preserveAspectRatio', 'xMidYMid meet');
      svgEl.style.background = 'transparent';

      const viewBoxAttr = svgEl.getAttribute('viewBox');
      if (viewBoxAttr) {
        const parts = viewBoxAttr.split(/\s+/).map(Number);
        if (parts.length === 4 && parts[2] > 0 && parts[3] > 0) {
          aspectRatio = parts[2] / parts[3];
          if (!exportManualChange) {
            setExportDefaults(parts[2], parts[3]);
          }
        }
      }

      svgInner.replaceChildren(svgEl);
      applyViewport();
      clearSelection();
      attachEditing(svgEl);
      syncGlow(Number(glowRange.value));
      syncOutline(Number(outlineRange.value));
      syncInnerGlow(Number(innerGlowRange.value));
      syncInnerFillOpacity(Number(innerFillOpacityRange.value));
      captureCurrentSVG();
      downloadBtn.disabled = false;
      transparentPicker.disabled = false;
      makeTransparentBtn.disabled = false;
      updateEditControls();
      setStatus('SVG klar. Du kan nu finjustere og downloade uden at kre konvertering igen.');
    }

    function normalizeHex(value) {
      const hex = toHex(value);
      return hex ? hex.toLowerCase() : null;
    }

    function deleteSelected() {
      if (selectedElements.length === 0) return;
      selectedElements.forEach((el) => el.remove());
      captureCurrentSVG();
      clearSelection();
      setStatus('Slettede markerede elementer.');
    }

    function rotateSelected(delta) {
      selectedElements.forEach((el) => {
        const state = getTransformState(el);
        const rot = state.rot + delta;
        setTransformState(el, { ...state, rot });
      });
      captureCurrentSVG();
      setStatus('Rotr anvendt.');
    }

    function flipSelected(axis) {
      selectedElements.forEach((el) => {
        const state = getTransformState(el);
        const sx = axis === 'x' ? state.sx * -1 : state.sx;
        const sy = axis === 'y' ? state.sy * -1 : state.sy;
        setTransformState(el, { ...state, sx, sy });
      });
      captureCurrentSVG();
      setStatus('Spejlvending anvendt.');
    }

    function alignSelected(mode) {
      if (selectedElements.length < 2) return;
      const [anchor, ...rest] = selectedElements;
      const anchorBox = anchor.getBBox();
      rest.forEach((el) => {
        const box = el.getBBox();
        const state = getTransformState(el);
        let tx = state.tx;
        let ty = state.ty;

        switch (mode) {
          case 'left':
            tx += anchorBox.x - box.x;
            break;
          case 'center':
            tx += anchorBox.x + anchorBox.width / 2 - (box.x + box.width / 2);
            break;
          case 'right':
            tx += anchorBox.x + anchorBox.width - (box.x + box.width);
            break;
          case 'top':
            ty += anchorBox.y - box.y;
            break;
          case 'middle':
            ty += anchorBox.y + anchorBox.height / 2 - (box.y + box.height / 2);
            break;
          case 'bottom':
            ty += anchorBox.y + anchorBox.height - (box.y + box.height);
            break;
          default:
            break;
        }

        setTransformState(el, { ...state, tx, ty });
      });
      captureCurrentSVG();
      setStatus('Align anvendt i forhold til frste markerede element.');
    }

    function makeColorTransparent(hexColor) {
      const target = normalizeHex(hexColor);
      if (!target) {
        setStatus('Angiv en gyldig farve fr du gr den transparent.', true);
        return;
      }

      const svgEl = svgOutput.querySelector('svg');
      if (!svgEl) {
        setStatus('Ingen SVG at redigere endnu.', true);
        return;
      }

      const nodes = svgEl.querySelectorAll('path, rect, circle, ellipse, polygon, polyline, g');
      let changed = 0;
      nodes.forEach((node) => {
        if (!(node instanceof SVGElement)) return;
        const fill = node.getAttribute('fill') || '';
        const normalized = normalizeHex(fill);
        if (normalized && normalized === target) {
          if (!node.hasAttribute('data-original-fill')) {
            node.setAttribute('data-original-fill', fill);
          }
          node.setAttribute('fill', 'none');
          changed += 1;
        }
      });

      if (changed > 0) {
        captureCurrentSVG();
        setStatus(`Gjorde ${changed} element(er) transparente for ${target}.`);
      } else {
        setStatus('Ingen elementer med den valgte farve blev fundet.', true);
      }
    }

    function removeBackgroundByColor(hexColor) {
      const target = normalizeHex(hexColor);
      if (!target) {
        setStatus('Angiv en gyldig baggrundsfarve fr du fjerner den.', true);
        return;
      }

      const svgEl = svgOutput.querySelector('svg');
      if (!svgEl) {
        setStatus('Ingen SVG at redigere endnu.', true);
        return;
      }

      const nodes = svgEl.querySelectorAll('path, rect, circle, ellipse, polygon, polyline, g');
      let changed = 0;
      nodes.forEach((node) => {
        if (!(node instanceof SVGElement)) return;
        const fill = node.getAttribute('fill') || '';
        const stroke = node.getAttribute('stroke') || '';
        const normalizedFill = normalizeHex(fill);
        const normalizedStroke = normalizeHex(stroke);
        let nodeChanged = false;
        if (normalizedFill && normalizedFill === target) {
          node.setAttribute('fill', 'none');
          nodeChanged = true;
        }
        if (normalizedStroke && normalizedStroke === target) {
          node.setAttribute('stroke', 'none');
          nodeChanged = true;
        }
        if (nodeChanged) changed += 1;
      });

      if (changed > 0) {
        captureCurrentSVG();
        setStatus(`Fjernede baggrundsfarven ${target} fra ${changed} element(er).`);
      } else {
        setStatus('Ingen elementer med den valgte baggrundsfarve blev fundet.', true);
      }
    }

    function ensureDefs(svgEl) {
      let defs = svgEl.querySelector('defs');
      if (!defs) {
        defs = document.createElementNS(SVG_NS, 'defs');
        svgEl.insertBefore(defs, svgEl.firstChild);
      }
      return defs;
    }

    function applyGlowToSVG() {
      const svgEl = svgOutput.querySelector('svg');
      if (!svgEl) return;

      const outerAmount = syncNumeric(Number(glowRange.value), glowRange, glowNumber, glowValue, ' px', 50);
      const outlineAmount = syncNumeric(
        Number(outlineRange.value),
        outlineRange,
        outlineNumber,
        outlineValue,
        ' px',
        50,
      );
      const innerGlowAmount = syncNumeric(
        Number(innerGlowRange.value),
        innerGlowRange,
        innerGlowNumber,
        innerGlowValue,
        ' px',
        50,
      );
      const innerFillPercent = syncNumeric(
        Number(innerFillOpacityRange.value),
        innerFillOpacityRange,
        innerFillOpacityNumber,
        innerFillOpacityValue,
        '%',
        100,
      );
      const outerColor = glowColor.value || '#00ffff';
      const outlineColorValue = outlineColor.value || outerColor;
      const innerGlowColorValue = innerGlowColor.value || '#ffffff';
      const innerFillColorValue = innerFillColor.value || '#ffffff';

      const includeGlow = outerAmount > 0;
      const includeOutline = outlineAmount > 0;
      const includeInnerGlow = innerGlowAmount > 0;
      const includeInnerFill = innerFillPercent > 0;

      if (!includeGlow && !includeOutline && !includeInnerGlow && !includeInnerFill) {
        svgEl.style.filter = '';
        svgEl.removeAttribute('filter');
        captureCurrentSVG();
        return;
      }

      const defs = ensureDefs(svgEl);
      let filter = svgEl.querySelector(`#${GLOW_FILTER_ID}`);
      if (!filter) {
        filter = document.createElementNS(SVG_NS, 'filter');
        filter.id = GLOW_FILTER_ID;
        filter.setAttribute('x', '-50%');
        filter.setAttribute('y', '-50%');
        filter.setAttribute('width', '200%');
        filter.setAttribute('height', '200%');
        filter.setAttribute('color-interpolation-filters', 'sRGB');

        const blur = document.createElementNS(SVG_NS, 'feGaussianBlur');
        blur.id = 'glow-blur';
        blur.setAttribute('in', 'SourceAlpha');
        blur.setAttribute('result', 'blur');
        filter.appendChild(blur);

        const flood = document.createElementNS(SVG_NS, 'feFlood');
        flood.id = 'glow-flood';
        flood.setAttribute('result', 'flood');
        filter.appendChild(flood);

        const composite = document.createElementNS(SVG_NS, 'feComposite');
        composite.id = 'glow-composite';
        composite.setAttribute('in', 'flood');
        composite.setAttribute('in2', 'blur');
        composite.setAttribute('operator', 'in');
        composite.setAttribute('result', 'glow');
        filter.appendChild(composite);

        const outlineMorph = document.createElementNS(SVG_NS, 'feMorphology');
        outlineMorph.id = 'outline-morph';
        outlineMorph.setAttribute('in', 'SourceAlpha');
        outlineMorph.setAttribute('operator', 'dilate');
        outlineMorph.setAttribute('radius', '1');
        outlineMorph.setAttribute('result', 'outlineBase');
        filter.appendChild(outlineMorph);

        const outlineFlood = document.createElementNS(SVG_NS, 'feFlood');
        outlineFlood.id = 'outline-flood';
        outlineFlood.setAttribute('result', 'outlineFlood');
        filter.appendChild(outlineFlood);

        const outlineComposite = document.createElementNS(SVG_NS, 'feComposite');
        outlineComposite.id = 'outline-composite';
        outlineComposite.setAttribute('in', 'outlineFlood');
        outlineComposite.setAttribute('in2', 'outlineBase');
        outlineComposite.setAttribute('operator', 'in');
        outlineComposite.setAttribute('result', 'outline');
        filter.appendChild(outlineComposite);

        const innerGlowBlur = document.createElementNS(SVG_NS, 'feGaussianBlur');
        innerGlowBlur.id = 'inner-glow-blur';
        innerGlowBlur.setAttribute('in', 'SourceAlpha');
        innerGlowBlur.setAttribute('result', 'innerGlowBlur');
        filter.appendChild(innerGlowBlur);

        const innerGlowComposite = document.createElementNS(SVG_NS, 'feComposite');
        innerGlowComposite.id = 'inner-glow-composite';
        innerGlowComposite.setAttribute('in', 'innerGlowBlur');
        innerGlowComposite.setAttribute('in2', 'SourceAlpha');
        innerGlowComposite.setAttribute('operator', 'in');
        innerGlowComposite.setAttribute('result', 'innerGlowMask');
        filter.appendChild(innerGlowComposite);

        const innerGlowFlood = document.createElementNS(SVG_NS, 'feFlood');
        innerGlowFlood.id = 'inner-glow-flood';
        innerGlowFlood.setAttribute('result', 'innerGlowFlood');
        filter.appendChild(innerGlowFlood);

        const innerGlowFinal = document.createElementNS(SVG_NS, 'feComposite');
        innerGlowFinal.id = 'inner-glow-final';
        innerGlowFinal.setAttribute('in', 'innerGlowFlood');
        innerGlowFinal.setAttribute('in2', 'innerGlowMask');
        innerGlowFinal.setAttribute('operator', 'in');
        innerGlowFinal.setAttribute('result', 'innerGlow');
        filter.appendChild(innerGlowFinal);

        const innerFillFlood = document.createElementNS(SVG_NS, 'feFlood');
        innerFillFlood.id = 'inner-fill-flood';
        innerFillFlood.setAttribute('result', 'innerFillFlood');
        filter.appendChild(innerFillFlood);

        const innerFillComposite = document.createElementNS(SVG_NS, 'feComposite');
        innerFillComposite.id = 'inner-fill-composite';
        innerFillComposite.setAttribute('in', 'innerFillFlood');
        innerFillComposite.setAttribute('in2', 'SourceAlpha');
        innerFillComposite.setAttribute('operator', 'in');
        innerFillComposite.setAttribute('result', 'innerFill');
        filter.appendChild(innerFillComposite);

        const merge = document.createElementNS(SVG_NS, 'feMerge');
        const mergeOutline = document.createElementNS(SVG_NS, 'feMergeNode');
        mergeOutline.id = 'merge-outline-node';
        mergeOutline.setAttribute('in', 'outline');
        merge.appendChild(mergeOutline);
        const mergeGlow = document.createElementNS(SVG_NS, 'feMergeNode');
        mergeGlow.id = 'merge-glow-node';
        mergeGlow.setAttribute('in', 'glow');
        merge.appendChild(mergeGlow);
        const mergeSource = document.createElementNS(SVG_NS, 'feMergeNode');
        mergeSource.id = 'merge-source-node';
        mergeSource.setAttribute('in', 'SourceGraphic');
        merge.appendChild(mergeSource);
        const mergeInnerFill = document.createElementNS(SVG_NS, 'feMergeNode');
        mergeInnerFill.id = 'merge-inner-fill-node';
        mergeInnerFill.setAttribute('in', 'innerFill');
        merge.appendChild(mergeInnerFill);
        const mergeInnerGlow = document.createElementNS(SVG_NS, 'feMergeNode');
        mergeInnerGlow.id = 'merge-inner-glow-node';
        mergeInnerGlow.setAttribute('in', 'innerGlow');
        merge.appendChild(mergeInnerGlow);
        filter.appendChild(merge);

        defs.appendChild(filter);
      }

      const blurNode = filter.querySelector('#glow-blur');
      const floodNode = filter.querySelector('#glow-flood');
      const morphNode = filter.querySelector('#outline-morph');
      const outlineFlood = filter.querySelector('#outline-flood');
      const innerGlowBlur = filter.querySelector('#inner-glow-blur');
      const innerGlowFlood = filter.querySelector('#inner-glow-flood');
      const innerFillFlood = filter.querySelector('#inner-fill-flood');
      if (blurNode) {
        blurNode.setAttribute('stdDeviation', includeGlow ? String(Math.max(0.1, outerAmount / 2)) : '0');
      }
      if (floodNode) {
        floodNode.setAttribute('flood-color', outerColor);
        floodNode.setAttribute('flood-opacity', includeGlow ? '1' : '0');
      }
      if (morphNode) {
        morphNode.setAttribute('radius', includeOutline ? String(Math.max(0.1, outlineAmount / 3)) : '0');
      }
      if (outlineFlood) {
        outlineFlood.setAttribute('flood-color', outlineColorValue);
        outlineFlood.setAttribute('flood-opacity', includeOutline ? '1' : '0');
      }
      if (innerGlowBlur) {
        innerGlowBlur.setAttribute('stdDeviation', includeInnerGlow ? String(Math.max(0.1, innerGlowAmount / 2)) : '0');
      }
      if (innerGlowFlood) {
        innerGlowFlood.setAttribute('flood-color', innerGlowColorValue);
        innerGlowFlood.setAttribute('flood-opacity', includeInnerGlow ? '1' : '0');
      }
      if (innerFillFlood) {
        innerFillFlood.setAttribute('flood-color', innerFillColorValue);
        innerFillFlood.setAttribute('flood-opacity', includeInnerFill ? String(innerFillPercent / 100) : '0');
      }

      svgEl.style.filter = `url(#${GLOW_FILTER_ID})`;
      captureCurrentSVG();
    }

    deleteBtn.addEventListener('click', deleteSelected);
    rotateLeftBtn.addEventListener('click', () => rotateSelected(-15));
    rotateRightBtn.addEventListener('click', () => rotateSelected(15));
    flipHBtn.addEventListener('click', () => flipSelected('x'));
    flipVBtn.addEventListener('click', () => flipSelected('y'));
    alignLeftBtn.addEventListener('click', () => alignSelected('left'));
    alignCenterBtn.addEventListener('click', () => alignSelected('center'));
    alignRightBtn.addEventListener('click', () => alignSelected('right'));
    alignTopBtn.addEventListener('click', () => alignSelected('top'));
    alignMiddleBtn.addEventListener('click', () => alignSelected('middle'));
    alignBottomBtn.addEventListener('click', () => alignSelected('bottom'));

    async function convertToSVG() {
      const imageData = await ensureImageData();
      if (!imageData) return;
      if (!(await ensureTracer())) return;

      clearSelection();
      downloadBtn.disabled = true;
      const options = mapOptions();
      setStatus('Sporer konturer  dette kan tage lidt tid for detaljerede billeder.');

      try {
        const svgString = ImageTracer.imagedataToSVG(imageData, options);
        if (!svgString || typeof svgString !== 'string') {
          throw new Error('Tomt SVG-resultat');
        }
        renderSVG(svgString);
      } catch (error) {
        console.error(error);
        const message = error instanceof Error ? error.message : 'ukendt fejl';
        setStatus(`Vektorisering mislykkedes (${message}). Prv med lavere detaljeringsgrad eller mindre billede.`, true);
      }
    }

    convertBtn.addEventListener('click', convertToSVG);

    downloadBtn.addEventListener('click', () => {
      if (!lastSVG) return;
      const width = clampDimension(exportWidth.value, originalDimensions.width || 1024);
      let height = clampDimension(exportHeight.value, originalDimensions.height || 1024);
      if (lockAspect.checked && aspectRatio > 0) {
        height = Math.max(1, Math.round(width / aspectRatio));
        exportHeight.value = String(height);
      }

      const parsed = new DOMParser().parseFromString(lastSVG, 'image/svg+xml');
      const svgEl = parsed.querySelector('svg');
      if (!svgEl) return;
      if (!svgEl.getAttribute('viewBox')) {
        svgEl.setAttribute('viewBox', `0 0 ${width} ${height}`);
      }
      svgEl.setAttribute('width', `${width}px`);
      svgEl.setAttribute('height', `${height}px`);

      const serialized = new XMLSerializer().serializeToString(svgEl);
      const blob = new Blob([serialized], { type: 'image/svg+xml' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      const safeName = currentFileBase ? `${currentFileBase.replace(/\.svg$/i, '')}.svg` : 'vectorized.svg';
      a.href = url;
      a.download = safeName;
      a.click();
      URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>
